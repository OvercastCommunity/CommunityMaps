<map proto="1.5.0">
<name>Infection: Skull Island</name>
<version>2.0.3</version>
<created>2025-09-12</created>
<phase>staging</phase>
<constants>
    <constant id="infected-team-name">Infected</constant>
    <constant id="infected-team-color">dark green</constant>
    <constant id="human-team-color">gold</constant>
    <constant id="time-limit">9</constant> <!-- Time limit in minutes -->
    <constant id="compass-distribution-time">2</constant>
    <constant id="border-start">4</constant>
    <constant id="spawn-switch">5</constant> <!-- move infected spawn to center cause border -->
    <constant id="enable-player-tracker">always</constant>
    <constant id="release-seconds">45</constant>
</constants>
<objective>The Humans must survive against the Infected for ${time-limit} minutes!</objective>
<gamemode>infection</gamemode>
<broadcasts>
    <tip after="4s" filter="human-team">You are a Human.</tip>
    <tip after="6s" filter="human-team">To win, survive the Infected attack for ${time-limit} minutes.</tip>
    <tip after="10s" filter="human-team">If you die, you join the ${infected-team-name}!</tip>
    <tip after="4s" filter="infected-team">You are an Infected, you must kill all of the Humans to win!</tip>
    <alert after="${compass-distribution-time}m" filter="${enable-player-tracker}">${infected-team-name} can now track the nearest Human with a compass!</alert>
    <alert after="${spawn-switch}m">${infected-team-name} now spawn in the center!</alert>
</broadcasts>
<teams>
    <team id="infected-team" color="${infected-team-color}" plural="true" min="1" max="5">${infected-team-name}</team>
    <team id="human-team" color="${human-team-color}" show-name-tags="false" plural="true" min="1" max="40">Humans</team>
</teams>
<time result="human-team">${time-limit}m</time>
<blitz filter="never" join-filter="always">
    <broadcastLives>false</broadcastLives>
</blitz>
<respawn auto="true"/>
<authors>
    <author uuid="c25a6f7b-4c42-40da-8cd6-add53f0c84eb"/> <!-- arcadeboss -->
</authors>
<rules>
    <rule>Name tags for Humans don't show</rule>
</rules>
<broadcasts>
    <alert after="1s">The ${infected-team-name} will be released after ${release-seconds} seconds!</alert>
    <alert after="${release-seconds}s">The ${infected-team-name} have been released!</alert>
</broadcasts>
<world-borders center="0.5,0.5" damage="0.1">
    <world-border size="800"/>
    <world-border size="245" after="${border-start}m" duration="0s"/>
    <world-border size="80" after="${border-start}m" duration="4m30s"/> <!-- duration = time-limit - border-start - 30s -->
    <!-- release everyone, including observers in the last moments -->
    <world-border size="1000" after="8m56s" duration="4s"/> <!-- time-limit - 4s -->
</world-borders>
<maxbuildheight>128</maxbuildheight>
<spawns>
    <default yaw="90" region="obs-spawn-point"/>
    <spawn team="human-team" kit="humans-kit" safe="true" filter="before-30s">
        <regions>
            <point yaw="135">5.5,99,5.5</point>
            <point yaw="45">5.5,99,-4.5</point>
            <point yaw="-45">-4.5,101,-4.5</point>
            <point yaw="-135">-4.5,101,5.5</point>
        </regions>
    </spawn>
    <spawn team="human-team" kit="infected-switch-kit" filter="after-30s" region="obs-spawn-point"/>
    <spawn team="infected-team" kit="infected-kit-start" filter="before-30s">
       <regions>
            <point yaw="90">94.5,101,0.5</point> <!-- face west -->
            <point yaw="-90">-93.5,101,0.5</point> <!-- face east -->
            <point yaw="0">0.5,101,-93.5</point> <!-- face south -->
            <point yaw="180">0.5,101,94.5</point> <!-- face north -->
        </regions>
    </spawn>
    <spawn team="infected-team" kit="infected-kit" filter="all(after-30s,not(infected-spawn-switch))">
        <regions>
            <point yaw="90">94.5,101,0.5</point> <!-- face west -->
            <point yaw="-90">-93.5,101,0.5</point> <!-- face east -->
            <point yaw="0">0.5,101,-93.5</point> <!-- face south -->
            <point yaw="180">0.5,101,94.5</point> <!-- face north -->
        </regions>
    </spawn>
    <spawn team="infected-team" kit="infected-kit" filter="infected-spawn-switch">
        <regions>
            <point yaw="135">5.5,99,5.5</point>
            <point yaw="45">5.5,99,-4.5</point>
            <point yaw="-45">-4.5,101,-4.5</point>
            <point yaw="-135">-4.5,101,5.5</point>
        </regions>
    </spawn>
</spawns>
<kits>
    <kit id="infected-kit">
        <helmet locked="true" unbreakable="true" team-color="true" enchantment="fire_protection:2" material="leather helmet"/>
        <chestplate locked="true" unbreakable="true" enchantment="fire_protection:2" material="iron chestplate"/>
        <leggings locked="true" unbreakable="true" team-color="true" material="leather leggings"/>
        <boots locked="true" unbreakable="true" team-color="true" material="leather boots"/>
        <item slot="0" unbreakable="true" material="iron sword"/>
        <item slot="1" unbreakable="true" material="bow"/>
        <item slot="2" material="leaves" amount="64"/>
        <item slot="3" material="vine" amount="64"/>
        <item slot="4" material="shears" enchantment="efficiency:10"/>
        <item slot="5" material="tnt" amount="2" lore="`3For `2Leaves`r`3 and `6Humans`r"/>
        <item slot="6" material="potion" damage="2" lore="`4Speed II, 30 seconds">
            <effect amplifier="2" duration="30">speed</effect>
        </item>
        <item slot="8" material="arrow" amount="40"/>
        <item slot="11" material="leaves" amount="64"/>
        <item slot="20" material="leaves" amount="64"/>
        <item slot="29" material="leaves" amount="64"/>
        <item slot="30" material="vine" amount="64"/>
        <item slot="31" material="shears" enchantment="efficiency:10"/>
        <effect>speed</effect>
        <effect duration="3s" amplifier="255">resistance</effect>
    </kit>
    <kit id="infected-kit-start" parent="infected-kit">
        <effect duration="25">blindness</effect>
        <effect duration="${release-seconds}s" amplifier="255">regeneration</effect>
        <effect duration="60s">absorption</effect>
    </kit>
    <kit id="humans-kit">
        <helmet unbreakable="true" team-color="true" material="leather helmet"/>
        <chestplate unbreakable="true" team-color="true" material="leather chestplate"/>
        <leggings unbreakable="true" team-color="true" material="leather leggings"/>
        <boots unbreakable="true" team-color="true" material="leather boots"/>
        <item slot="0" unbreakable="true" material="iron sword"/>
        <item slot="1" unbreakable="true" material="bow"/>
        <item slot="2" material="vine" amount="64"/>
        <item slot="3" material="leaves" amount="64"/>
        <item slot="4" material="ender_pearl" amount="2"/>
        <item slot="5" material="potion" damage="9" name="Witch Doctor Potion" lore="`3Strength and Healing Medicine">
            <effect duration="15s">strength</effect>
            <effect amplifier="2" duration="30">regeneration</effect>
            <effect duration="60s">absorption</effect>
        </item>
        <item slot="6" material="compass"/>
        <item slot="8" material="arrow" amount="64"/>
        <item slot="11" material="vine" amount="64"/>
        <item slot="12" material="leaves" amount="64"/>
        <item slot="20" material="vine" amount="64"/>
        <item slot="21" material="leaves" amount="64"/>
        <item slot="30" material="leaves" amount="64"/>
        <item slot="29" material="vine" amount="64"/>
        <effect>speed</effect>
        <effect duration="0">absorption</effect>
        <effect duration="6s" amplifier="255">resistance</effect>
    </kit>
    <kit id="infected-switch-kit" force="true">
        <team-switch team="infected-team"/>
    </kit>
</kits>
<compass show-distance="true">
    <player filter="human-team" holder-filter="infected-team" name="`eClosest Human"/>
    <player filter="infected-team" holder-filter="human-team" name="`eClosest Infected"/>
</compass>
<filters>
    <deny id="deny-participating">
        <participating/>
    </deny>
    <alive id="alive"/>
    <match-running id="match-running"/>
    <not id="before-30s">
        <time id="after-30s">31s</time>
    </not>
    <time id="infected-spawn-switch">${spawn-switch}m</time>
    <time id="border-start-filter">${border-start}m</time>
    <!-- allow players to break leaves, vines, etc -->
    <deny id="original-block-protection">
        <any>
            <all>
                <any>
                    <cause>explosion</cause>
                </any>
                <not>
                    <any>
                        <material>leaves</material>
                        <material>leaves 2</material>
                        <material>vine</material>
                        <material>double plant</material>
                        <material>long grass</material>
                    </any>
                </not>
            </all>
            <all>
                <any>
                    <cause>player</cause>
                </any>
                <not>
                    <any>
                        <material>leaves</material>
                        <material>leaves 2</material>
                        <material>vine</material>
                        <material>double plant</material>
                        <material>long grass</material>
                        <material>brown mushroom</material>
                        <material>red mushroom</material>
                        <material>red rose</material>
                        <material>yellow flower</material>
                        <material>fire</material>
                    </any>
                </not>
            </all>
        </any>
    </deny>
</filters>
<regions>
    <point id="obs-spawn-point">0.5,128,0.5</point>
    <above y="144" id="ceiling"/>
    <union id="cages">
        <cuboid id="west" min="-90,101,-1" max="-91,104,2"/>
        <cuboid id="east" min="90,101,-1" max="92,104,2"/>
        <cuboid id="north" min="-1,101,-90" max="2,104,-92"/>
        <cuboid id="south" min="-1,101,91" max="2,104,92"/>
    </union>
    <negative id="no-go">
        <rectangle min="-120,-120" max="120,120"/>
    </negative>
    <apply block-break="original-block-protection" message="You may only remove leaves and vines!"/>
    <apply enter="never" region="ceiling" message="You may not go higher!"/>
    <apply enter="never" region="no-go" message="You may not go beyond this point!"/>
</regions>
<actions>
    <trigger scope="player">
        <action>
            <kit>
                <item prevent-sharing="true" material="compass"/>
            </kit>
            <sound preset="portal"/>
        </action>
        <filter>
            <all>
                <filter id="${enable-player-tracker}"/>
                <filter id="infected-team"/>
                <time>${compass-distribution-time}m</time>
                <filter id="alive"/>
                <not>
                    <carrying>
                        <item material="compass"/>
                    </carrying>
                </not>
            </all>
        </filter>
    </trigger>
    <trigger scope="match">
        <filter>
            <after message="${infected-team-name} released in {0}" duration="${release-seconds}s" filter="match-running"/>
        </filter>
        <action>
            <message fade-in="0.5s" stay="3s" fade-out="0.5s">
                <title>`c${infected-team-name} Released!</title>
            </message>
            <fill region="cages" material="air"/>
            <sound preset="objective_bad"/>
        </action>
    </trigger>
    <trigger filter="border-start-filter" scope="match">
        <action>
            <sound preset="portal"/>
            <message text="`7[`e`lAlert`7] `6`oThe world border is approaching!`r"/>
        </action>
    </trigger>
</actions>
<kill-rewards>
    <kill-reward filter="human-team">
        <item material="potion" damage="9" name="Witch Doctor Potion" lore="`3Strength and Healing Medicine">
            <effect duration="15s">strength</effect>
            <effect duration="3s">regeneration</effect>
            <effect duration="60s">absorption</effect>
        </item>
        <item material="arrow" amount="10"/>
    </kill-reward>
    <kill-reward filter="infected-team">
        <item material="tnt" lore="`3For `2Leaves`r`3 and `6Humans`r"/>
        <item material="arrow" amount="8"/>
    </kill-reward>
    <kill-reward>
        <item material="flint and steel" damage="63"/> <!-- 2 uses -->
        <filter>
            <all>
                <team>infected-team</team>
                <kill-streak count="2" repeat="false"/>
            </all>
        </filter>
    </kill-reward>
    <kill-reward>
        <item material="fireball" projectile="throwable-fireball" name="`rFireball"/>
        <filter>
            <all>
                <team>infected-team</team>
                <kill-streak count="3" repeat="false"/>
            </all>
        </filter>
    </kill-reward>
</kill-rewards>
<projectiles>
    <projectile id="throwable-fireball" name="Fireball" projectile="Fireball" velocity=".6" click="right" power="4" damage="1" cooldown="1s"/>
</projectiles>
<tnt>
    <instantignite>true</instantignite>
    <blockdamage>true</blockdamage>
    <friendly-defuse>off</friendly-defuse>
    <fuse>3s</fuse>
    <yield>0</yield>
    <power>5</power>
</tnt>
<damage>
    <deny>
        <all>
            <cause>fall</cause>
        </all>
    </deny>
</damage>
<disabledamage>
    <damage ally="true" self="true" enemy="false" other="false">block explosion</damage>
</disabledamage>
<itemremove>
    <item>arrow</item>
    <item>leather helmet</item>
    <item>leather chestplate</item>
    <item>leather leggings</item>
    <item>leather boots</item>
    <item>iron sword</item>
    <item>diamond sword</item>
    <item>diamond helmet</item>
    <item>diamond chestplate</item>
    <item>diamond leggings</item>
    <item>diamond boots</item>
    <item>potion</item>
    <item>stick</item>
    <item>bow</item>
    <item>tnt</item>
    <item>compass</item>
    <item>sapling</item>
    <item>shears</item>
    <item>vine</item>
    <item>leaves</item>
    <item>leaves 2</item>
    <item>brown mushroom</item>
    <item>red mushroom</item>
    <item>apple</item>
    <item>red rose</item>
    <item>yellow flower</item>
</itemremove>
<hunger>
    <depletion>off</depletion>
</hunger>
</map>
