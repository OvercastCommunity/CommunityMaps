<map proto="1.5.0">
<name>Pizza Time</name>
<version>2.0.1</version>
<objective>Destroy the blocks below your enemies, and eat toppings to get bonuses!</objective>
<created>2023-07-04</created>
<game>Pizza Spleef</game>
<include id="void-death"/>
<constants>
    <constant id="void-plane">63</constant>
</constants>
<authors>
    <author uuid="9d4779a8-d35f-45d2-b51c-95de7a77e128"/> <!-- zzuf -->
</authors>
<contributors>
    <contributor uuid="55a2e72e-0161-4c85-b191-a0b227ff758a" contribution="Pizza Spleef creator"/> <!-- SethBling -->
</contributors>
<players max="10" colors="true" show-name-tags="false"/>
<broadcasts>
    <alert after="4m10s">`fAll players will receive `6Fireball `fprojectiles in 20 seconds!</alert>
    <alert after="4m30s">`fAll players have received `6Fireball `fprojectiles!</alert>
</broadcasts>
<difficulty>hard</difficulty>
<spawns>
    <spawn kit="spawn-kit" safe="true" filter="not(current_pizza=2)">
        <regions angle="0.5,65,0.5">
            <cylinder base="16.5,64,0.5" height="0" radius="8"/>
            <cylinder base="-15.5,64,0.5" height="0" radius="8"/>
            <cylinder base="0.5,64,16.5" height="0" radius="8"/>
            <cylinder base="0.5,64,-15.5" height="0" radius="8"/>
        </regions>
    </spawn>
    <spawn kit="spawn-kit" safe="true" filter="current_pizza=2">
        <regions angle="0.5,67,0.5">
            <cylinder base="16.5,66,0.5" height="0" radius="8"/>
            <cylinder base="-15.5,66,0.5" height="0" radius="8"/>
            <cylinder base="0.5,66,16.5" height="0" radius="8"/>
            <cylinder base="0.5,66,-15.5" height="0" radius="8"/>
        </regions>
    </spawn>
    <default kit="obs-kit">
        <region>
            <cylinder base="0.5,100,-58.5" height="0" radius="0.5"/>
        </region>
    </default>
</spawns>
<kits>
    <kit id="spawn-kit">
        <item name="`fPizza Cutter" lore="`8Cuts right through pizza" material="diamond pickaxe" enchantments="efficiency:6" unbreakable="true"/>
        <effect amplifier="127">resistance</effect>
        <effect amplifier="4">hunger</effect>
        <saturation>0</saturation>
    </kit>
    <kit id="before-match-end-kit">
        <item name="`fAnti-Camping Measure" material="fireball" amount="3" projectile="fireball-projectile"/>
    </kit>
    <give kit="before-match-end-kit" filter="all(4m30s,participating)"/>
    <kit id="obs-kit">
        <book show-other="false">
            <title>`e`lIngredients</title>
            <author>zzuf</author>
            <pages>
                <page>
                    `2» `lPIZZA SPLEEF`0

                    `nClassic ingredients:`0

                    `c`lPepperoni:`0 Speed
                    `8`lOlive:`0 Blindness
                    `a`lPepper:`0 Jump Boost
                    `7`lOnion:`0 Invisibility
                    `4`lSausage:`0 Explosives
                    `6`lMushroom:`0 Slowness
                    `e`lEgg:`0 Nausea
                </page>
                <page>
                    `2» `lPIZZA SPLEEF`0

                    `nCustom ingredients:`0

                    `e`lPineapple:`0 Poison
                    `d`lHam:`0 Haste
                    `4`lLiquorice:`0 Explosives
                    `7`lMarshmallow:`0 Speed
                    `6`lChip:`0 Jump Boost
                    `e`lSprinkle:`0 Invisibility
                    `b`lJelly Bean:`0 Nausea
                </page>
            </pages>
        </book>
    </kit>
</kits>
<projectiles>
    <projectile id="fireball-projectile" name="Fireball" projectile="Fireball" click="right" damage="10" power="4" throwable="true" cooldown="1s"/>
</projectiles>
<blitz/>
<time>5m</time>
<filters>
    <time id="4m30s">4m30s</time>
    <after duration="20s" message="`fAll players will receive `6Fireball `fprojectiles in {0}">
        <time>4m10s</time>
    </after>
    <deny id="deny-explosions">
        <cause>explosion</cause>
    </deny>
</filters>
<regions>
    <apply block="never" enter="never">
        <region>
            <union>
                <cylinder base="0.5,95,-58.5" height="oo" radius="12"/> <!-- Observer spawn -->
                <rectangle min="-34,60" max="35,129"/> <!-- Pizza rack -->
            </union>
        </region>
    </apply>
    <apply block="never">
        <region>
            <below y="63"/>
        </region>
    </apply>
    <cuboid id="worse" min="-32,60,62" max="33,63,127"/>
    <translate id="bad" region="worse" offset="0,6,0"/>
    <translate id="detroit" region="worse" offset="0,12,0"/>
    <cuboid id="stuffed" min="-32,78,62" max="33,83,127"/>
    <translate id="candy" region="detroit" offset="0,12,0"/>
</regions>
<variables>
    <variable id="eater" scope="player" exclusive="1"/>
    <variable id="current_pizza" scope="match" default="0"/>
</variables>
<actions>
    <action id="yum" scope="player">
        <action filter="player.food=0..15">
            <set var="player.food" value="player.food+5"/>
        </action>
        <action filter="player.food=16..">
            <set var="player.food" value="20"/>
        </action>
    </action>
    <action id="yum2" scope="player">
        <action filter="player.food=0..19">
            <set var="player.food" value="player.food+1"/>
        </action>
        <action filter="player.food=20..">
            <set var="player.food" value="20"/>
        </action>
    </action>
    <action id="give-blindness" scope="match">
        <switch-scope outer="match" inner="player">
            <action id="give-blindness-effect"/>
        </switch-scope>
    </action>
    <action id="give-nausea" scope="match">
        <switch-scope outer="match" inner="player">
            <action id="give-nausea-effect"/>
        </switch-scope>
    </action>
    <!-- Effects -->
    <action filter="participating" id="give-blindness-effect" scope="player">
        <kit force="true">
            <effect duration="7s">blindness</effect>
        </kit>
    </action>
    <action filter="participating" id="give-nausea-effect" scope="player">
        <kit>
            <effect>nausea</effect>
        </kit>
    </action>
    <!-- Misc. -->
    <trigger scope="match">
        <filter>
            <after duration="2s" filter="match-starting"/>
        </filter>
        <action>
            <set var="current_pizza" value="floor(random()*6)"/>
            <message text=" » `aA {pizza-type}`a pizza has been chosen!">
                <replacements>
                    <switch id="pizza-type" value="current_pizza">
                        <case match="1" result="`d`lCandy"/>
                        <case match="2" result="`e`lStuffed"/>
                        <case match="3" result="`b`lDetroit-style"/>
                        <case match="4" result="`c`lHawaiian"/>
                        <case match="5" result="`7`lFugazzeta"/>
                        <fallback>`f`lClassic</fallback>
                    </switch>
                </replacements>
            </message>
            <sound/>
        </action>
    </trigger>
</actions>
<structures clear="false" air="true">
    <structure id="pizza-worse" region="worse"/>
    <structure id="pizza-bad" region="bad"/>
    <structure id="pizza-detroit" region="detroit"/>
    <structure id="pizza-stuffed" region="stuffed"/>
    <structure id="pizza-candy" region="candy"/>
    <dynamic structure="pizza-worse" location="-32,63,-32" trigger="current_pizza=5"/>
    <dynamic structure="pizza-bad" location="-32,63,-32" trigger="current_pizza=4"/>
    <dynamic structure="pizza-detroit" location="-32,63,-32" trigger="current_pizza=3"/>
    <dynamic structure="pizza-stuffed" location="-32,63,-32" trigger="current_pizza=2"/>
    <dynamic structure="pizza-candy" location="-32,63,-32" trigger="current_pizza=1"/>
</structures>
<block-drops>
    <rule>
        <filter>
            <all>
                <material>redstone block</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect amplifier="2" duration="5s">speed</effect>
            <action>
                <message text=" » `fYou ate a `cPepperoni`f! `7You're faster for the next `e5 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>obsidian</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <action>
                <set var="eater" value="1"/>
                <switch-scope outer="player" inner="match">
                    <message text=" » `f{player} ate an `8Olive`f! `7Everyone else is blind for `e7 `7seconds!">
                        <replacements>
                            <player id="player" var="eater"/>
                        </replacements>
                    </message>
                    <action id="give-blindness"/>
                    <sound/>
                </switch-scope>
                <kit force="true">
                    <effect duration="0s">blindness</effect>
                </kit>
                <action id="yum"/>
            </action>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>wool:5</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect amplifier="6" duration="10s">jump_boost</effect>
            <action>
                <message text=" » `fYou ate a `aPepper`f! `7You jump higher for the next `e10 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>stained glass:0</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect duration="10s">invisibility</effect>
            <action>
                <message text=" » `fYou ate an `7Onion`f! `7You're invisible for the next `e10 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>wood:1</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <item material="monster egg" damage="50" name="`fExplosive" amount="3"/>
            <action>
                <message text=" » `fYou ate a `4Sausage`f! `7You've received some explosives!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>soul sand</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <item material="potion" damage="16394" name="`fSlow Bomb" lore="Slows down your enemies, but be careful not to hit yourself!" amount="3">
                <effect duration="15s" amplifier="2">slowness</effect>
            </item>
            <action>
                <message text=" » `fYou ate a `6Mushroom`f! `7You've received some slowness potions!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>gold block</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <action>
                <set var="eater" value="1"/>
                <switch-scope outer="player" inner="match">
                    <message text=" » `f{player} ate an `eEgg`f! `7Everyone else is nauseous for the rest of the game!">
                        <replacements>
                            <player id="player" var="eater"/>
                        </replacements>
                    </message>
                    <action id="give-nausea"/>
                    <sound/>
                </switch-scope>
                <kit force="true">
                    <effect duration="0s">nausea</effect>
                </kit>
                <action id="yum"/>
            </action>
        </kit>
    </rule>
    <!-- Custom -->
    <rule>
        <filter>
            <all>
                <material>stained glass:4</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect duration="4s">poison</effect>
            <action>
                <message text=" » `fYou ate some `ePineapple`f! `7You get a bittersweet taste for the next `e4 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>wool:6</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect amplifier="6" duration="10s">haste</effect>
            <action>
                <message text=" » `fYou ate some `dHam`f! `7You break some blocks faster for the next `e10 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>stained glass:14</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <item material="monster egg" damage="50" name="`fExplosive" amount="3"/>
            <action>
                <message text=" » `fYou ate some `4Liquorice`f! `7You've received some explosives!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>wool:0</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect amplifier="2" duration="5s">speed</effect>
            <action>
                <message text=" » `fYou ate a `7Marshmallow`f! `7You're faster for the next `e5 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>wood:5</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect amplifier="6" duration="10s">jump_boost</effect>
            <action>
                <message text=" » `fYou ate a `6Chocolate Chip`f! `7You jump higher for the next `e10 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>wool:4</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <effect duration="10s">invisibility</effect>
            <action>
                <message text=" » `fYou ate a `eSprinkle`f! `7You're invisible for the next `e10 `7seconds!"/>
            </action>
            <action id="yum"/>
        </kit>
    </rule>
    <rule>
        <filter>
            <all>
                <material>diamond block</material>
                <filter id="deny-explosions"/>
            </all>
        </filter>
        <kit force="true">
            <action>
                <set var="eater" value="1"/>
                <switch-scope outer="player" inner="match">
                    <message text=" » `f{player} ate a `bJelly Bean`f! `7Everyone else is nauseous for the rest of the game!">
                        <replacements>
                            <player id="player" var="eater"/>
                        </replacements>
                    </message>
                    <action id="give-nausea"/>
                    <sound/>
                </switch-scope>
                <kit force="true">
                    <effect duration="0s">nausea</effect>
                </kit>
                <action id="yum"/>
            </action>
        </kit>
    </rule>
    <rule>
        <filter>
            <any>
                <material>sandstone</material>
                <material>stained clay</material>
            </any>
        </filter>
        <kit>
            <action id="yum2"/>
        </kit>
    </rule>
</block-drops>
<gamerules>
    <doMobLoot>false</doMobLoot>
</gamerules>
<toolrepair>
    <tool>diamond pickaxe</tool>
</toolrepair>
<damage>
    <not>
        <any>
            <relation>ally</relation>
        </any>
    </not>
</damage>
</map>
