<map proto="1.5.0">
<name>Perfect Match</name>
<version>1.0.2</version>
<objective>Memorize the tiles on the floor and move to the matching one to avoid falling!</objective>
<created>2025-11-05</created>
<phase>staging</phase>
<gamemode>arcade</gamemode>
<authors>
    <author uuid="64e840c8-4fb5-4659-a36b-ff93e2f6113a"/> <!-- Javg_ -->
</authors>
<contributors>
    <contributor uuid="b0523368-9363-4d24-877a-aa1f6342eda0" contribution="Building help"/> <!-- Palmenikoo -->
    <contributor uuid="d5a64b26-15ea-46c4-8319-f9c83e82a1fa" contribution="Gradient sorting"/> <!-- Eliminate -->
</contributors>
<constants>
    <constant id="BLOCKS_AMOUNT">93</constant>
    <constant id="ANNOUNCER_PREFIX">`a[Announcer]:`r</constant>
    <!-- match phases -->
    <constant id="PHASE_TUTORIAL">1</constant>
    <constant id="PHASE_GAME">2</constant>
    <!-- round states -->
    <constant id="ROUND_PREPARING">1</constant>
    <constant id="ROUND_MEMORY">2</constant>
    <constant id="ROUND_BLANK">3</constant>
    <constant id="ROUND_SCREEN">4</constant>
    <constant id="ROUND_CLEAR">5</constant>
    <constant id="ROUND_FINISHED">6</constant>
</constants>
<players max="50" colors="true"/>
<blitz join-filter="not(current_phase=${PHASE_GAME})">
    <broadcastLives>false</broadcastLives>
</blitz>
<kits>
    <kit id="default-kit">
        <game-mode>adventure</game-mode>
    </kit>
</kits>
<spawns>
    <default>
        <region yaw="-90">
            <point>-54.5,3,0.5</point>
        </region>
        <region yaw="0">
            <point>0.5,3,-54.5</point>
        </region>
        <region yaw="90">
            <point>55.5,3,0.5</point>
        </region>
        <region yaw="180">
            <point>0.5,3,55.5</point>
        </region>
    </default>
    <spawn kit="default-kit">
        <region>
            <cuboid min="14.5,11,-13.5" max="-13.5,11,14.5"/>
        </region>
    </spawn>
</spawns>
<regions>
    <apply block-break="never">
        <region>
            <everywhere/>
        </region>
    </apply>
</regions>
<structures>
    <structure id="screen-z-structure" air="true">
        <region>
            <cuboid min="13,16,18" max="-12,30,19"/>
        </region>
    </structure>
    <structure id="screen-x-structure" air="true">
        <region>
            <cuboid min="-17,16,13" max="-18,30,-12"/>
        </region>
    </structure>
    <structure id="in-between-protections-structure" origin="0.5,36,0.5">
        <region>
            <cuboid min="15,35,-14" max="-14,36,15"/>
        </region>
    </structure>
    <dynamic structure="in-between-protections-structure" trigger="not(round_state=${ROUND_CLEAR})" location="0.5,11,0.5"/>
</structures>
<filters>
    <any id="fill-filter">
        <material id="barrier">barrier</material>
        <variable var="only_barrier">0</variable>
    </any>
    <!-- round states -->
    <all id="round-preparing">
        <variable var="round_state">${ROUND_PREPARING}</variable>
        <match-running/>
    </all>
    <all id="round-memory">
        <variable var="round_state">${ROUND_MEMORY}</variable>
        <match-running/>
    </all>
    <all id="round-blank">
        <variable var="round_state">${ROUND_BLANK}</variable>
        <match-running/>
    </all>
    <all id="round-screen">
        <variable var="round_state">${ROUND_SCREEN}</variable>
        <match-running/>
    </all>
    <all id="round-clear">
        <variable var="round_state">${ROUND_CLEAR}</variable>
        <match-running/>
    </all>
    <all id="round-finished">
        <variable var="round_state">${ROUND_FINISHED}</variable>
        <match-running/>
    </all>
</filters>
<variables scope="match">
    <array id="starting_platform_xz" size="2"/>
    <array id="platforms_xz" size="72"/>
    <array id="selected_blocks" size="36"/>
    <array id="filtered_blocks" size="36"/>
    <variable id="selection_amount" default="12"/>
    <variable id="currently_placing_block"/>
    <variable id="good_block"/>
    <variable id="block_similarity" default="0"/>  <!-- from 0 to 1 -->
    <variable id="gatekeep_likeliness"/>           <!-- from 0 to 1 -->
    <variable id="i"/>
    <variable id="j"/>
    <variable id="p"/>
    <variable id="min_value"/>
    <variable id="max_value"/>
    <variable id="offset"/>
    <variable id="calc"/>
    <variable id="compare"/>
    <variable id="should_repeat"/>
    <variable id="only_barrier"/>
    <variable id="rotation"/>
    <!-- regions -->
    <cuboid id="platform_cursor" min="0,10,0" max="1,11,1"/>
    <cuboid id="deleter_cursor" min="0,9,0" max="1,11,1"/>
    <cuboid id="screen_south" min="-12,16,18" max="13,30,19"/>
    <cuboid id="screen_north" min="-12,16,-18" max="13,30,-17"/>
    <cuboid id="screen_east" min="18,16,-12" max="19,30,13"/>
    <cuboid id="screen_west" min="-18,16,-12" max="-17,30,13"/>
    <!-- messages -->
    <variable id="current_message" default="-1"/>
    <!-- game -->
    <variable id="round_count"/>
    <variable id="round_state"/>
    <variable id="current_phase" default="-1"/>
    <variable id="tutorial_done"/>
    <variable id="players_left"/>
    <!-- calls -->
    <variable id="call_reset_yaw"/>
    <!-- player -->
    <variable id="final_player_one" exclusive="1" scope="player"/>
    <variable id="final_player_two" exclusive="1" scope="player"/>
</variables>
<actions>
    <!-- register platform positions -->
    <trigger scope="match" filter="always">
        <action>
            <set var="starting_platform_xz" index="0" value="15"/>
            <set var="starting_platform_xz" index="1" value="15"/>
            <set var="i" value="0"/> <!-- z -->
            <set var="p" value="0"/>
            <repeat times="6">
                <set var="j" value="0"/> <!-- x --> 
                <repeat times="6">
                    <set var="platforms_xz" index="p" value="starting_platform_xz[0] - (5 * j)"/>
                    <set var="platforms_xz" index="p+1" value="starting_platform_xz[1] - (5 * i)"/>
                    <set var="j" value="j+1"/>
                    <set var="p" value="p+2"/>
                </repeat>
                <set var="i" value="i+1"/>
            </repeat>
            <set var="i" value="0"/>
        </action>
    </trigger>
    
    <action id="roll" scope="match" expose="true">
        <!-- reset -->
        <set var="i" value="0"/>
        <repeat times="36">
            <set var="selected_blocks" index="i" value="0"/>
            <set var="filtered_blocks" index="i" value="0"/>
            <set var="i" value="i + 1"/>
        </repeat>
        <!-- cap the max similarity to .96 -->
        <action filter="block_similarity=0.97..">
            <set var="block_similarity" value="0.96"/>
        </action>
        <!-- cap the max gatekeep likeliness to .80 -->
        <action filter="gatekeep_likeliness=0.81..">
            <set var="gatekeep_likeliness" value="0.80"/>
        </action>
        <!-- cap the max selection amount to 36 -->
        <action filter="selection_amount=37..">
            <set var="selection_amount" value="36"/>
        </action>
        <!-- select blocks -->
        <set var="i" value="selection_amount - 1"/>
        <set var="min_value" value="99999"/>
        <set var="max_value" value="-99999"/>
        <repeat times="10000" filter="not(i=-1)">
            <set var="calc" value="selection_amount - (ceil(${BLOCKS_AMOUNT} * (1 - block_similarity)))"/>
            <action filter="calc=1..">
                <!-- reset selection_amount if the selected amount is too much for the selected similarity -->
                <set var="selection_amount" value="ceil(${BLOCKS_AMOUNT} * (1 - block_similarity))"/>
            </action>
            <set var="should_repeat" value="0"/>
            <set var="selected_blocks" index="i" value="floor(random() * (${BLOCKS_AMOUNT} * (1 - block_similarity))) + 1"/>
            <set var="j" value="selection_amount - 1"/>
            <repeat times="(selection_amount - 1) - i">
                <set var="compare" value="selected_blocks[i]-selected_blocks[j]"/>
                <action filter="compare=0">
                    <set var="should_repeat" value="1"/>
                </action>
                <set var="j" value="j-1"/>
            </repeat>
            <action filter="should_repeat=0">
                <set var="min_value" value="min(min_value,selected_blocks[i])"/>
                <set var="max_value" value="max(max_value,selected_blocks[i])"/>
                <set var="i" value="i-1"/>
            </action>
        </repeat>
        <!-- set offset -->
        <set var="offset" value="0"/>
        <set var="should_repeat" value="1"/>
        <set var="i" value="${BLOCKS_AMOUNT}"/>
        <repeat times="10000" filter="should_repeat=1">
            <set var="offset" value="floor(random() * i)"/>
            <set var="compare" value="max_value + offset"/>
            <action filter="compare=${BLOCKS_AMOUNT}..">
                <!-- the offset is too high, it goes past the blocks amount -->
                <set var="i" value="i - 1"/>
            </action>
            <action filter="not(compare=${BLOCKS_AMOUNT}..)">
                <set var="should_repeat" value="0"/>
            </action>
        </repeat>
        <set var="i" value="0"/>
        <!-- apply offset -->
        <repeat times="36">
            <action filter="selected_blocks[i]=0">
                <set var="filtered_blocks" index="i" value="selected_blocks[floor(random() * selection_amount)] + offset"/>
            </action>
            <action filter="not(selected_blocks[i]=0)">
                <set var="filtered_blocks" index="i" value="selected_blocks[i] + offset"/>
            </action>
            <set var="i" value="i+1"/>
        </repeat>
        <!-- select good block -->
        <set var="i" value="floor(random() * 36)"/>
        <set var="good_block" value="filtered_blocks[i]"/>
    </action>

    <action id="display-tiles" scope="match" expose="true">
        <set var="i" value="0"/>
        <set var="p" value="0"/>
        <repeat times="36">
            <set var="currently_placing_block" value="filtered_blocks[i]"/>
            <set var="calc" value="floor(random() + (1 - gatekeep_likeliness))"/>
            <action filter="calc=0">
                <set var="currently_placing_block" value="0"/>
            </action>
            <set var="platform_cursor" index="3" value="platforms_xz[p]"/>
            <set var="platform_cursor" index="5" value="platforms_xz[p+1]"/>
            <set var="platform_cursor" index="0" value="platforms_xz[p]-4"/>
            <set var="platform_cursor" index="2" value="platforms_xz[p+1]-4"/>
            <action id="fill"/>
            <set var="i" value="i + 1"/>
            <set var="p" value="p + 2"/>
        </repeat>
    </action>

    <action id="destroy-tiles" scope="match" expose="true">
        <set var="i" value="0"/>
        <set var="p" value="0"/>
        <repeat times="36">
            <action filter="not(filtered_blocks[i]-good_block=0)">
                <set var="deleter_cursor" index="3" value="platforms_xz[p]"/>
                <set var="deleter_cursor" index="5" value="platforms_xz[p+1]"/>
                <set var="deleter_cursor" index="0" value="platforms_xz[p]-4"/>
                <set var="deleter_cursor" index="2" value="platforms_xz[p+1]-4"/>
                <action filter="current_phase=${PHASE_TUTORIAL}">
                    <fill region="deleter_cursor" material="barrier"/>
                </action>
                <action filter="not(current_phase=${PHASE_TUTORIAL})">
                    <fill region="deleter_cursor" material="air"/>
                </action>
            </action>
            <set var="i" value="i + 1"/>
            <set var="p" value="p + 2"/>
        </repeat>
    </action>

    <action id="reset-tiles" scope="match" expose="true">
        <set var="i" value="0"/>
        <set var="p" value="0"/>
        <repeat times="36">
            <set var="currently_placing_block" value="0"/>
            <set var="platform_cursor" index="3" value="platforms_xz[p]"/>
            <set var="platform_cursor" index="4" value="11"/>
            <set var="platform_cursor" index="5" value="platforms_xz[p+1]"/>
            <set var="platform_cursor" index="0" value="platforms_xz[p]-4"/>
            <set var="platform_cursor" index="1" value="10"/>
            <set var="platform_cursor" index="2" value="platforms_xz[p+1]-4"/>
            <action id="fill"/>
            <set var="currently_placing_block" value="-1"/>
            <set var="platform_cursor" index="1" value="9"/>
            <set var="platform_cursor" index="4" value="10"/>
            <action id="fill"/>
            <set var="i" value="i + 1"/>
            <set var="p" value="p + 2"/>
        </repeat>
        <set var="currently_placing_block" value="0"/>
        <set var="platform_cursor" index="1" value="10"/>
        <set var="platform_cursor" index="4" value="11"/>
    </action>

    <action id="display-screens" scope="match" expose="true">
        <paste-structure structure="screen-z-structure" x="-11" y="17" z="19" update="false"/>
        <paste-structure structure="screen-x-structure" x="-17" y="17" z="-11" update="false"/>
        <paste-structure structure="screen-z-structure" x="-11" y="17" z="-17" update="false"/>
        <paste-structure structure="screen-x-structure" x="19" y="17" z="-11" update="false"/>
        <set var="only_barrier" value="1"/>
        <set var="currently_placing_block" value="good_block"/>
        <set var="rotation" value="0"/>
        <set var="platform_cursor" index="0" value="screen_south[0]"/>
        <set var="platform_cursor" index="1" value="screen_south[1]"/>
        <set var="platform_cursor" index="2" value="screen_south[2]"/>
        <set var="platform_cursor" index="3" value="screen_south[3]"/>
        <set var="platform_cursor" index="4" value="screen_south[4]"/>
        <set var="platform_cursor" index="5" value="screen_south[5]"/>
        <action id="fill"/>
        <set var="platform_cursor" index="0" value="screen_north[0]"/>
        <set var="platform_cursor" index="1" value="screen_north[1]"/>
        <set var="platform_cursor" index="2" value="screen_north[2]"/>
        <set var="platform_cursor" index="3" value="screen_north[3]"/>
        <set var="platform_cursor" index="4" value="screen_north[4]"/>
        <set var="platform_cursor" index="5" value="screen_north[5]"/>
        <action id="fill"/>
        <set var="rotation" value="1"/>
        <set var="platform_cursor" index="0" value="screen_east[0]"/>
        <set var="platform_cursor" index="1" value="screen_east[1]"/>
        <set var="platform_cursor" index="2" value="screen_east[2]"/>
        <set var="platform_cursor" index="3" value="screen_east[3]"/>
        <set var="platform_cursor" index="4" value="screen_east[4]"/>
        <set var="platform_cursor" index="5" value="screen_east[5]"/>
        <action id="fill"/>
        <set var="platform_cursor" index="0" value="screen_west[0]"/>
        <set var="platform_cursor" index="1" value="screen_west[1]"/>
        <set var="platform_cursor" index="2" value="screen_west[2]"/>
        <set var="platform_cursor" index="3" value="screen_west[3]"/>
        <set var="platform_cursor" index="4" value="screen_west[4]"/>
        <set var="platform_cursor" index="5" value="screen_west[5]"/>
        <action id="fill"/>

        <set var="only_barrier" value="0"/>
        <set var="platform_cursor" index="1" value="10"/>
        <set var="platform_cursor" index="4" value="11"/>
    </action>

    <action id="destroy-screens" scope="match" expose="true">
        <fill material="air">
            <union>
                <region id="screen_south"/>
                <region id="screen_north"/>
                <region id="screen_east"/>
                <region id="screen_west"/>
            </union>
        </fill>
    </action>

    <!-- game state setters -->
    <trigger scope="match" filter="match-started" action="current_phase:=${PHASE_TUTORIAL}"/>
    <trigger scope="match" filter="tutorial_done=1" action="current_phase:=${PHASE_GAME}"/>

    <!-- round state setters -->
    <trigger scope="match" action="round_state:=${ROUND_PREPARING}">
        <filter>
            <after duration="2s" filter="current_phase=${PHASE_GAME}"/>
        </filter>
    </trigger> 
    <trigger scope="match" action="round_state:=${ROUND_MEMORY}">
        <filter>
            <after duration="2s" filter="round-preparing"/>
        </filter>
    </trigger>
    <trigger scope="match" action="round_state:=${ROUND_BLANK}">
        <filter>
            <any>
                <after duration="15s" filter="all(round-memory,round_count=1..6)" message="Hiding blocks in {0}"/>
                <after duration="10s" filter="all(round-memory,round_count=7..14)" message="Hiding blocks in {0}"/>
                <after duration="5s" filter="all(round-memory,round_count=15..)" message="Hiding blocks in {0}"/>
            </any>
        </filter>
    </trigger>
    <trigger scope="match" action="round_state:=${ROUND_SCREEN}">
        <filter>
            <after duration="2s" filter="round-blank"/>
        </filter>
    </trigger>
    <trigger scope="match" action="round_state:=${ROUND_CLEAR}">
        <filter>
            <after duration="10s" filter="round-screen" message="Clearing tiles in {0}"/>
        </filter>
    </trigger>
    <trigger scope="match" action="round_state:=${ROUND_FINISHED}">
        <filter>
            <after duration="5s" filter="round-clear"/>
        </filter>
    </trigger>
    <trigger scope="match" action="round_state:=${ROUND_PREPARING}">
        <filter>
            <after duration="0.5s" filter="round-finished"/>
        </filter>
    </trigger>

    <!-- rounds -->
    <trigger scope="match" filter="round-preparing">
        <action>
            <set var="round_count" value="round_count + 1"/>
            <set var="selection_amount" value="2 + floor(round_count * 1.8)"/>
            <set var="block_similarity" value="random()"/>
            <set var="gatekeep_likeliness" value="0.05 * (round_count - 1)"/>
            <action id="roll"/>
            <action id="calculate-playercount"/>
            <action id="announce-round"/>
        </action>
    </trigger>

    <trigger scope="match">
        <filter>
            <pulse period="1.5s" duration="1s" filter="round-memory"/>
        </filter>
        <action>
            <action id="display-tiles"/>
        </action>
    </trigger>

    <trigger scope="match" filter="round-blank">
        <action>
            <action id="reset-tiles"/>
            <switch-scope inner="player" filter="participating"> 
                <set var="call_reset_yaw" value="1"/>   <!-- viaversion (?) bug workaround -->
            </switch-scope>
        </action>
    </trigger>

    <trigger scope="match" filter="round-screen">
        <action>
            <action id="display-screens"/>
        </action>
    </trigger>

    <trigger scope="match" filter="round-clear">
        <action>
            <set var="gatekeep_likeliness" value="0"/>
            <action id="display-tiles"/>
            <action id="destroy-tiles"/>
        </action>
    </trigger>

    <trigger scope="match" filter="round-finished">
        <action>
            <action id="reset-tiles"/>
            <action id="destroy-screens"/>
        </action>
    </trigger>

    <!-- tutorial -->
    <trigger scope="match" action="current_message:=0">
        <filter>
            <after duration="1s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
    </trigger>
    <trigger scope="match">
        <filter>
            <after duration="4s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
        <action>
            <set var="current_message" value="1"/>
            <set var="selection_amount" value="6"/>
            <action id="roll"/>
            <action id="display-tiles"/>
        </action>
    </trigger>
    <trigger scope="match">
        <filter>
            <after duration="9s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
        <action>
            <set var="current_message" value="2"/>
            <action id="reset-tiles"/>
        </action>
    </trigger>
    <trigger scope="match">
        <filter>
            <after duration="14s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
        <action>
            <set var="current_message" value="3"/>
            <action id="display-screens"/>
        </action>
    </trigger>
    <trigger scope="match">
        <filter>
            <after duration="19s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
        <action>
            <set var="current_message" value="4"/>
            <action id="display-tiles"/>
            <action id="destroy-tiles"/>
        </action>
    </trigger>
    <trigger scope="match">
        <filter>
            <after duration="23s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
        <action>
            <set var="current_message" value="5"/>
            <action id="reset-tiles"/>
            <action id="destroy-screens"/>
        </action>
    </trigger>
    <trigger scope="match" action="tutorial_done:=1">
        <filter>
            <after duration="26s" filter="current_phase=${PHASE_TUTORIAL}"/>
        </filter>
    </trigger>

    <!-- messages -->
    <!-- depends on current_message -->
    <trigger scope="match" filter="all(current_phase=${PHASE_TUTORIAL},not(current_message=-1))">
        <action>
            <sound key="random.click"/>
            <message text="{text}">
                <replacements>
                    <switch id="text" value="current_message">
                        <case match="0" result="${ANNOUNCER_PREFIX} Welcome to &#34;Perfect Match&#34;"/>
                        <case match="1" result="${ANNOUNCER_PREFIX} In this game, your goal is to memorize the blocks shown on each floor tile."/>
                        <case match="2" result="${ANNOUNCER_PREFIX} After 15 seconds, all tiles will turn blank."/>
                        <case match="3" result="${ANNOUNCER_PREFIX} A random block will then appear on the screens."/>
                        <case match="4" result="${ANNOUNCER_PREFIX} Stand on any tile that originally displayed that block to avoid falling!"/>
                        <case match="5" result="${ANNOUNCER_PREFIX} Each round gets harder than the last, so don't get too confident!"/>
                    </switch>
                </replacements>
            </message>
            <action filter="current_message=0"> <!-- without this filter, the title dissapears too quickly -->
                <message title="{title}" subtitle="{subtitle}">
                    <replacements>
                        <switch id="title" value="current_message">
                            <case match="0" result="`l&#34;Perfect Match&#34;"/>
                        </switch>
                        <switch id="subtitle" value="current_message">
                            <case match="0" result="`aStand or Fall"/>
                        </switch>
                    </replacements>
                </message>
            </action>
            <set var="current_message" value="-1"/>
        </action>
    </trigger>

    <!-- ticking sound -->
    <trigger scope="match">
        <filter>
            <pulse period="1s" duration="0.5s">
                <any>
                    <after duration="10s" filter="all(round-memory,round_count=1..6)"/>
                    <after duration="5s" filter="all(round-memory,round_count=7..14)"/>
                    <after duration="0.05s" filter="all(round-memory,round_count=15..)"/>
                </any>
            </pulse>
        </filter>
        <action>
            <sound key="random.click" volume="0.25" pitch="2"/>
        </action>
    </trigger>

    <action id="announce-round" scope="match">
        <action filter="round_count=7">
            <message text="${ANNOUNCER_PREFIX} Memory time has been reduced to `a10 seconds!"/>
        </action>
        <action filter="round_count=15">
            <message text="${ANNOUNCER_PREFIX} Memory time has been reduced to `a5 seconds!"/>
        </action>
        <action filter="not(players_left=2)">
            <sound key="${entity.player.levelup}"/>
            <message title="Round `a{r}" subtitle="`a{p} `f{word} left" stay="2s">
                <replacements>
                    <decimal id="r" value="round_count"/>
                    <decimal id="p" value="players_left"/>
                    <switch id="word" value="players_left">
                        <case match="1" result="Player"/>
                        <fallback>Players</fallback>
                    </switch>
                </replacements>
            </message>
        </action>
        <action filter="players_left=2">
            <sound key="${entity.lightning_bolt.thunder}"/>
            <message title="Round `d{r}" subtitle="{p1} vs {p2}" stay="2s">
                <replacements>
                    <decimal id="r" value="round_count"/>
                    <player id="p1" var="final_player_one"/>
                    <player id="p2" var="final_player_two"/>
                </replacements>
            </message>
        </action>
    </action>

    <action id="calculate-playercount" scope="match">
        <set var="players_left" value="0"/>
        <switch-scope inner="player" filter="all(participating,alive)">
            <set var="players_left" value="players_left + 1"/>
        </switch-scope>
        <action filter="players_left=2">
            <set var="j" value="0"/>
            <switch-scope inner="player" filter="all(participating,alive)">
                <action filter="j=0">
                    <set var="final_player_one" value="1"/>
                </action>
                <action filter="j=1">
                    <set var="final_player_two" value="1"/>
                </action>
                <set var="j" value="j + 1"/>
            </switch-scope>
        </action>
    </action>

    <action id="fill" scope="match">
        <action filter="currently_placing_block=-1"><fill filter="fill-filter" update="false" region="platform_cursor" material="barrier"/></action>
        <action filter="currently_placing_block=0"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_glass"/></action>
        <action filter="currently_placing_block=1"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:11"/></action>
        <action filter="currently_placing_block=2"><fill filter="fill-filter" update="false" region="platform_cursor" material="lapis_block"/></action>
        <action filter="currently_placing_block=3"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:11"/></action>
        <action filter="currently_placing_block=4"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:3"/></action>
        <action filter="currently_placing_block=5"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:3"/></action>
        <action filter="currently_placing_block=6"><fill filter="fill-filter" update="false" region="platform_cursor" material="diamond_block"/></action>
        <action filter="currently_placing_block=7"><fill filter="fill-filter" update="false" region="platform_cursor" material="packed_ice"/></action>
        <action filter="currently_placing_block=8"><fill filter="fill-filter" update="false" region="platform_cursor" material="ice"/></action>
        <action filter="currently_placing_block=9"><fill filter="fill-filter" update="false" region="platform_cursor" material="prismarine"/></action>
        <action filter="currently_placing_block=10"><fill filter="fill-filter" update="false" region="platform_cursor" material="prismarine:1"/></action>
        <action filter="currently_placing_block=11"><fill filter="fill-filter" update="false" region="platform_cursor" material="prismarine:2"/></action>
        <action filter="currently_placing_block=12"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:13"/></action>
        <action filter="currently_placing_block=13"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:13"/></action>
        <action filter="currently_placing_block=14"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:5"/></action>
        <action filter="currently_placing_block=15"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:5"/></action>
        <action filter="currently_placing_block=16"><fill filter="fill-filter" update="false" region="platform_cursor" material="slime_block"/></action>
        <action filter="currently_placing_block=17"><fill filter="fill-filter" update="false" region="platform_cursor" material="emerald_block"/></action>
        <action filter="currently_placing_block=18"><fill filter="fill-filter" update="false" region="platform_cursor" material="melon_block"/></action>
        <action filter="currently_placing_block=19"><fill filter="fill-filter" update="false" region="platform_cursor" material="sponge:1"/></action>
        <action filter="currently_placing_block=20"><fill filter="fill-filter" update="false" region="platform_cursor" material="sponge"/></action>
        <action filter="currently_placing_block=21"><fill filter="fill-filter" update="false" region="platform_cursor" material="sand"/></action>
        <action filter="currently_placing_block=22"><fill filter="fill-filter" update="false" region="platform_cursor" material="ender_stone"/></action>
        <action filter="currently_placing_block=23"><fill filter="fill-filter" update="false" region="platform_cursor" material="sandstone"/></action>
        <action filter="currently_placing_block=24"><fill filter="fill-filter" update="false" region="platform_cursor" material="gold_block"/></action>
        <action filter="currently_placing_block=25"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:4"/></action>
        <action filter="currently_placing_block=26"><fill filter="fill-filter" update="false" region="platform_cursor" material="hay_block"/></action>
        <action filter="currently_placing_block=27"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:4"/></action>
        <action filter="currently_placing_block=28"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:1"/></action>
        <action filter="currently_placing_block=29"><fill filter="fill-filter" update="false" region="platform_cursor" material="red_sandstone"/></action>
        <action filter="currently_placing_block=30"><fill filter="fill-filter" update="false" region="platform_cursor" material="sand:1"/></action>
        <action filter="currently_placing_block=31"><fill filter="fill-filter" update="false" region="platform_cursor" material="wood:4"/></action>
        <action filter="currently_placing_block=32"><fill filter="fill-filter" update="false" region="platform_cursor" material="pumpkin"/></action>
        <action filter="currently_placing_block=33"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:1"/></action>
        <action filter="currently_placing_block=34"><fill filter="fill-filter" update="false" region="platform_cursor" material="redstone_block"/></action>
        <action filter="currently_placing_block=35"><fill filter="fill-filter" update="false" region="platform_cursor" material="huge_mushroom_2:14"/></action>
        <action filter="currently_placing_block=36"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:14"/></action>
        <action filter="currently_placing_block=37"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:14"/></action>
        <action filter="currently_placing_block=38"><fill filter="fill-filter" update="false" region="platform_cursor" material="netherrack"/></action>
        <action filter="currently_placing_block=39"><fill filter="fill-filter" update="false" region="platform_cursor" material="brick"/></action>
        <action filter="currently_placing_block=40"><fill filter="fill-filter" update="false" region="platform_cursor" material="hard_clay"/></action>
        <action filter="currently_placing_block=41"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone:2"/></action>
        <action filter="currently_placing_block=42"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone:1"/></action>
        <action filter="currently_placing_block=43"><fill filter="fill-filter" update="false" region="platform_cursor" material="wood:3"/></action>
        <action filter="currently_placing_block=44"><fill filter="fill-filter" update="false" region="platform_cursor" material="huge_mushroom_1:14"/></action>
        <action filter="currently_placing_block=45"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:8"/></action>
        <action filter="currently_placing_block=46"><fill filter="fill-filter" update="false" region="platform_cursor" material="mycel"/></action>
        <action filter="currently_placing_block=47"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:10"/></action>
        <action filter="currently_placing_block=48"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:10"/></action>
        <action filter="currently_placing_block=49"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:2"/></action>
        <action filter="currently_placing_block=50"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:2"/></action>
        <action filter="currently_placing_block=51"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:6"/></action>
        <action filter="currently_placing_block=52"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:6"/></action>
        <action filter="currently_placing_block=53"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay"/></action>
        <action filter="currently_placing_block=54"><fill filter="fill-filter" update="false" region="platform_cursor" material="wood:2"/></action>
        <action filter="currently_placing_block=55"><fill filter="fill-filter" update="false" region="platform_cursor" material="wood"/></action>
        <action filter="currently_placing_block=56"><fill filter="fill-filter" update="false" region="platform_cursor" material="log:12"/></action>
        <action filter="currently_placing_block=57"><fill filter="fill-filter" update="false" region="platform_cursor" material="wood:1"/></action>
        <action filter="currently_placing_block=58"><fill filter="fill-filter" update="false" region="platform_cursor" material="log:15"/></action>
        <action filter="currently_placing_block=59"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:12"/></action>
        <action filter="currently_placing_block=60"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:12"/></action>
        <action filter="currently_placing_block=61"><fill filter="fill-filter" update="false" region="platform_cursor" material="soul_sand"/></action>
        <action filter="currently_placing_block=62"><fill filter="fill-filter" update="false" region="platform_cursor" material="wood:5"/></action>
        <action filter="currently_placing_block=63"><fill filter="fill-filter" update="false" region="platform_cursor" material="log_2:13"/></action>
        <action filter="currently_placing_block=64"><fill filter="fill-filter" update="false" region="platform_cursor" material="log:13"/></action>
        <action filter="currently_placing_block=65"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:15"/></action>
        <action filter="currently_placing_block=66"><fill filter="fill-filter" update="false" region="platform_cursor" material="obsidian"/></action>
        <action filter="currently_placing_block=67"><fill filter="fill-filter" update="false" region="platform_cursor" material="coal_block"/></action>
        <action filter="currently_placing_block=68"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:15"/></action>
        <action filter="currently_placing_block=69"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:7"/></action>
        <action filter="currently_placing_block=70"><fill filter="fill-filter" update="false" region="platform_cursor" material="stained_clay:9"/></action>
        <action filter="currently_placing_block=71"><fill filter="fill-filter" update="false" region="platform_cursor" material="log 2:12"/></action>
        <action filter="currently_placing_block=72"><fill filter="fill-filter" update="false" region="platform_cursor" material="bedrock"/></action>
        <action filter="currently_placing_block=73"><fill filter="fill-filter" update="false" region="platform_cursor" material="coal_ore"/></action>
        <action filter="currently_placing_block=74"><fill filter="fill-filter" update="false" region="platform_cursor" material="cobblestone"/></action>
        <action filter="currently_placing_block=75"><fill filter="fill-filter" update="false" region="platform_cursor" material="smooth_brick"/></action>
        <action filter="currently_placing_block=76"><fill filter="fill-filter" update="false" region="platform_cursor" material="smooth_brick:1"/></action>
        <action filter="currently_placing_block=77"><fill filter="fill-filter" update="false" region="platform_cursor" material="smooth_brick:2"/></action>
        <action filter="currently_placing_block=78"><fill filter="fill-filter" update="false" region="platform_cursor" material="smooth_brick:3"/></action>
        <action filter="currently_placing_block=79"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone"/></action>
        <action filter="currently_placing_block=80"><fill filter="fill-filter" update="false" region="platform_cursor" material="gravel"/></action>
        <action filter="currently_placing_block=81"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone:5"/></action>
        <action filter="currently_placing_block=82"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone:6"/></action>
        <action filter="currently_placing_block=83"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool:8"/></action>
        <action filter="currently_placing_block=84"><fill filter="fill-filter" update="false" region="platform_cursor" material="double_step:8"/></action>
        <action filter="currently_placing_block=85"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone:3"/></action>
        <action filter="currently_placing_block=86"><fill filter="fill-filter" update="false" region="platform_cursor" material="stone:4"/></action>
        <action filter="currently_placing_block=87"><fill filter="fill-filter" update="false" region="platform_cursor" material="huge_mushroom_1:15"/></action>
        <action filter="currently_placing_block=88"><fill filter="fill-filter" update="false" region="platform_cursor" material="log:14"/></action>
        <action filter="currently_placing_block=89"><fill filter="fill-filter" update="false" region="platform_cursor" material="quartz_block:1"/></action>
        <action filter="all(currently_placing_block=90,rotation=0)"><fill filter="fill-filter" update="false" region="platform_cursor" material="quartz_block:3"/></action>
        <action filter="all(currently_placing_block=90,rotation=1)"><fill filter="fill-filter" update="false" region="platform_cursor" material="quartz_block:4"/></action>
        <action filter="currently_placing_block=91"><fill filter="fill-filter" update="false" region="platform_cursor" material="quartz_block"/></action>
        <action filter="currently_placing_block=92"><fill filter="fill-filter" update="false" region="platform_cursor" material="wool"/></action>
        <action filter="currently_placing_block=93"><fill filter="fill-filter" update="false" region="platform_cursor" material="snow_block"/></action>
    </action>

    <trigger scope="player">
        <filter>
            <after duration="0.1" filter="call_reset_yaw=1"/>
        </filter>
        <action>
            <teleport x="player.x" y="player.y" z="player.z" yaw="player.yaw + 0.1"/>
            <set var="call_reset_yaw" value="0"/>
        </action>
    </trigger>
</actions>
<damage>
    <deny>
        <attacker>
            <always/>
        </attacker>
    </deny>
</damage>
<hunger>
    <depletion>off</depletion>
</hunger>
</map>
<!--
intentar hacer que las tiles hagan blinking, para evitar bug de viaversion
-->