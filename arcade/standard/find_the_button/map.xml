<map proto="1.5.0">
<name>Find the Button!</name>
<version>1.0.2</version>
<objective>Find the buttons along classic OCN maps!</objective>
<created>2025-11-12</created>
<game>Progress</game>
<phase>staging</phase>
<authors>
    <author uuid="b0523368-9363-4d24-877a-aa1f6342eda0" contribution="Idea, building"/> <!-- Palmenikoo -->
    <author uuid="cb5b83a3-e2d3-4198-9dee-6ceae43b9fd2" contribution="Building"/> <!-- ttam -->
    <author uuid="9c14b7e9-8488-427a-bc81-7193becde2d3" contribution="Building"/> <!-- TinyPigMX -->
</authors>
<contributors>
    <contributor uuid="19388047-f04b-43ac-9546-22aa69aea75c" contribution="Original 2014 Lobby author"/> <!-- Bleanny -->
    <contributor uuid="e5953ddf-c1fc-4405-9ac9-6939631cd185" contribution="Original The Fenland author"/> <!-- McSpider -->
    <contributor uuid="c14862ba-058a-44a2-a1c3-bfb0b462e198" contribution="Original Snowy Wars author"/> <!-- Ro_G -->
    <contributor uuid="ef4ea031-998f-4ec9-b7b6-1bdd428bcef8" contribution="Original Sunrise Over Paradise author"/> <!-- Plastix -->
    <contributor uuid="2a289d2a-d970-49c5-9a6c-01fc0264e317" contribution="Original Long Shot author"/> <!-- StealthMedia -->
    <contributor uuid="4a0780d3-d9c4-41c4-a816-e077a36f27c9" contribution="Original Long Shot author"/> <!-- KasiCrafter -->
    <contributor uuid="e5953ddf-c1fc-4405-9ac9-6939631cd185" contribution="Original Warlock author"/> <!-- McSpider -->
    <contributor uuid="06078e7e-6a7b-4d31-8f74-853072b182bb" contribution="Original 101 Rooms author"/> <!-- Frac -->
    <contributor uuid="73711d58-d786-4007-8c95-c93b1311de1a" contribution="Original Spaceship Battles author"/> <!-- Oversoul96 -->
    <contributor uuid="c33a03bf-0f73-46e2-a93e-ddb7d25232d1" contribution="Original Fractal Descent author"/> <!-- Teheggi -->
    <contributor uuid="459fd919-0d58-401a-9601-6cab1eb721ab" contribution="Original Fractal Descent, Golden Drought author"/> <!-- Reshif -->
    <contributor uuid="5ca79703-1be6-4dca-9073-59d024eb8bb0" contribution="Original Monument Valley author"/> <!-- koipen -->
    <contributor uuid="5e1c0b5d-cfdd-4e10-95cd-c53f8ee92150" contribution="Original Balloons DTM author"/> <!-- VCRHeadCleaner -->
    <contributor uuid="3143b9d9-cea7-465f-97fc-8de59fbbb3a4" contribution="Original Cargo author"/> <!-- DiamondAx -->
    <contributor uuid="e39fe3bc-b80e-46d2-81fe-d18042471989" contribution="Original Cargo author"/> <!-- EnarRikardz -->
    <contributor uuid="f64546c7-917b-4caf-a0c9-caa120156a84" contribution="Original Cargo author"/> <!-- BrunoTheMiner -->
    <contributor uuid="e82504ac-8c95-4895-9dca-222f924d697c" contribution="Original Cargo author"/> <!-- TiggyLi -->
    <contributor uuid="5c934a59-fd50-48aa-99ff-c87e0468f639" contribution="Original Cargo author"/> <!-- iamramsey -->
    <contributor uuid="41373965-b60a-40d5-8fad-72e61d951ea2" contribution="Original Cargo author"/> <!-- Rokosnocone -->
    <contributor uuid="3fbec7dd-0a5f-40bf-9d11-885a54507112" contribution="Original BoomBox author"/> <!-- Cubist -->
    <contributor uuid="dad8b95c-cf6a-44df-982e-8c8dd70201e0" contribution="Original Directrix, Canopy author"/> <!-- ElectroidFilms -->
    <contributor uuid="00c06fa6-1c53-4634-931a-929efd8a52df" contribution="Original Hot Dam author"/> <!-- Nadastorm -->
    <contributor uuid="64e840c8-4fb5-4659-a36b-ff93e2f6113a" contribution="Schizo XML"/> <!-- Javg_ -->
</contributors>
<players max="60" colors="true"/>
<score limit="18"/>
<kits>
    <kit id="empty-kit" filter="not(current_stage=17)">
        <clear/>
        <game-mode>adventure</game-mode>
        <effect>invisibility</effect>
        <boots material="leather boots" team-color="true" locked="true"/>
    </kit>
    <kit id="button-kit" filter="not(current_stage=17)">
        <clear/>
        <game-mode>adventure</game-mode>
        <effect>invisibility</effect>
        <boots material="leather boots" team-color="true"/>
        <item slot="0" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="1" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="2" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="3" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="4" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="5" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="6" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="7" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
        <item slot="8" material="wool" damage="4" consumable="button-consumable" name="`c`lPress it!"/>
    </kit>
</kits>
<regions>
    <point id="stage-0-spawn">-108.5,6.5,43.5</point>
    <point id="stage-1-spawn-1">-75.5,8,85.5</point>
    <point id="stage-1-spawn-2">-75.5,8,67.5</point>
    <point id="stage-2-spawn-1">-83.5,5,46.5</point>
    <point id="stage-2-spawn-2">-67.5,5,62.5</point>
    <point id="stage-3-spawn-1">-75.5,6,41.5</point>
    <point id="stage-3-spawn-2">-75.5,6,23.5</point>
    <point id="stage-4-spawn-1">-70.5,8,18.5</point>
    <point id="stage-4-spawn-2">-80.5,8,18.5</point>
    <point id="stage-5-spawn-1">-61.5,9,1.5</point>
    <point id="stage-5-spawn-2">-45.5,9,19.5</point>
    <point id="stage-6-spawn-1">-60,6,26</point>
    <point id="stage-6-spawn-2">-47,6,39</point>
    <point id="stage-7-spawn-1">-58.5,13.5,60.5</point>
    <point id="stage-7-spawn-2">-58.5,13.5,48.5</point>
    <point id="stage-8-spawn-1">-53.5,6,67.5</point>
    <point id="stage-8-spawn-2">-53.5,6,85.5</point>
    <point id="stage-9-spawn-1">-41.5,9,68.5</point>
    <point id="stage-9-spawn-2">-21.5,9,68.5</point>
    <point id="stage-10-spawn-1">-25,6,59</point>
    <point id="stage-10-spawn-2">-38,6,50</point>
    <point id="stage-11-spawn-1">-31.5,6,24.5</point>
    <point id="stage-11-spawn-2">-31.5,6,40.5</point>
    <point id="stage-12-spawn">-22.5,11,19.5</point>
    <point id="stage-13-spawn-1">-19.5,6,20.5</point>
    <point id="stage-13-spawn-2">0.5,6,0.5</point>
    <point id="stage-14-spawn-1">-17.5,2,32.5</point>
    <point id="stage-14-spawn-2">-1.5,2,32.5</point>
    <point id="stage-15-spawn-1">-10.5,8,63.5</point>
    <point id="stage-15-spawn-2">-0.5,8,53.5</point>
    <point id="stage-16-spawn-1">-1,2.5,77</point>
    <point id="stage-16-spawn-2">-18,2.5,76</point>
    <!-- directrix -->
    <apply velocity="0,1.4,0.8">
        <region>
            <block>-9.5,3,23.5</block>
        </region>
    </apply>
    <!-- canopy -->
    <apply velocity="1,1,0">
        <region>
            <block>-16.5,7,80.5</block>
        </region>
    </apply>
    <apply velocity="-1,1,0">
        <region>
            <block>-2.6,7,72.5</block>
        </region>
    </apply>
    <apply block-break="never">
        <region>
            <everywhere/>
        </region>
    </apply>
</regions>
<spawns>
    <default>
        <region yaw="135">
            <point>-105.5,6,46.5</point>
        </region>
        <region yaw="45">
            <point>-105.5,6,40.5</point>
        </region>
        <region yaw="-45">
            <point>-111.5,6,40.5</point>
        </region>
        <region yaw="-135">
            <point>-111.5,6,46.5</point>
        </region>
    </default>
    <spawn kit="empty-kit" filter="current_stage=0"> <!-- lobby -->
        <region yaw="90">
            <region id="stage-0-spawn"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=1">
        <region yaw="180">
            <region id="stage-1-spawn-1"/>
        </region>
        <region yaw="0">
            <region id="stage-1-spawn-2"/>
        </region>
    </spawn>
        <spawn kit="empty-kit" filter="current_stage=2">
        <region yaw="-45">
            <region id="stage-2-spawn-1"/>
        </region>
        <region yaw="135">
            <region id="stage-2-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=3">
        <region yaw="180">
            <region id="stage-3-spawn-1"/>
        </region>
        <region yaw="0">
            <region id="stage-3-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=4">
        <region yaw="180">
            <region id="stage-4-spawn-1"/>
        </region>
        <region yaw="180">
            <region id="stage-4-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=5">
        <region yaw="-90">
            <region id="stage-5-spawn-1"/>
        </region>
        <region yaw="90">
            <region id="stage-5-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=6">
        <region yaw="-45">
            <region id="stage-6-spawn-1"/>
        </region>
        <region yaw="135">
            <region id="stage-6-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=7">
        <region yaw="-90">
            <region id="stage-7-spawn-1"/>
        </region>
        <region yaw="-90">
            <region id="stage-7-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=8">
        <region yaw="0">
            <region id="stage-8-spawn-1"/>
        </region>
        <region yaw="180">
            <region id="stage-8-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=9">
        <region yaw="-45">
            <region id="stage-9-spawn-1"/>
        </region>
        <region yaw="45">
            <region id="stage-9-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=10">
        <region yaw="90">
            <region id="stage-10-spawn-1"/>
        </region>
        <region yaw="-90">
            <region id="stage-10-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=11">
        <region yaw="0">
            <region id="stage-11-spawn-1"/>
        </region>
        <region yaw="180">
            <region id="stage-11-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=12">
        <region yaw="135">
            <region id="stage-12-spawn"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=13">
        <region yaw="-135">
            <region id="stage-13-spawn-1"/>
        </region>
        <region yaw="45">
            <region id="stage-13-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=14">
        <region yaw="-90">
            <region id="stage-14-spawn-1"/>
        </region>
        <region yaw="90">
            <region id="stage-14-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=15">
        <region yaw="90">
            <region id="stage-15-spawn-1"/>
        </region>
        <region yaw="180">
            <region id="stage-15-spawn-2"/>
        </region>
    </spawn>
    <spawn kit="empty-kit" filter="current_stage=16">
        <region yaw="0">
            <region id="stage-16-spawn-1"/>
        </region>
        <region yaw="180">
            <region id="stage-16-spawn-2"/>
        </region>
    </spawn>
</spawns>
<structures>
    <structure id="button-up" origin="-98.5,34,78.5">
        <region>
            <block>-98.5,34,78.5</block>
        </region>
    </structure>
    <structure id="button-west" origin="-97.5,35,78.5">
        <region>
            <block>-97.5,35,78.5</block>
        </region>
    </structure>
    <structure id="button-east" origin="-99.5,35,78.5">
        <region>
            <block>-99.5,35,78.5</block>
        </region>
    </structure>
    <structure id="button-north" origin="-98.5,35,79.5">
        <region>
            <block>-98.5,35,79.5</block>
        </region>
    </structure>
    <structure id="button-south" origin="-98.5,35,77.5">
        <region>
            <block>-98.5,35,77.5</block>
        </region>
    </structure>
    <structure id="button-down" origin="-98.5,36,78.5">
        <region>
            <block>-98.5,36,78.5</block>
        </region>
    </structure>
</structures>
<portals sound="false">
    <portal forward="all(current_stage=1,spawn_seed=1)" destination="stage-1-spawn-1" pitch="@0" yaw="@180"/>
    <portal forward="all(current_stage=1,spawn_seed=2)" destination="stage-1-spawn-2" pitch="@0" yaw="@0"/>

    <portal forward="all(current_stage=2,spawn_seed=1)" destination="stage-2-spawn-1" pitch="@0" yaw="@-45"/>
    <portal forward="all(current_stage=2,spawn_seed=2)" destination="stage-2-spawn-2" pitch="@0" yaw="@135"/>

    <portal forward="all(current_stage=3,spawn_seed=1)" destination="stage-3-spawn-1" pitch="@0" yaw="@180"/>
    <portal forward="all(current_stage=3,spawn_seed=2)" destination="stage-3-spawn-2" pitch="@0" yaw="@0"/>

    <portal forward="all(current_stage=4,spawn_seed=1)" destination="stage-4-spawn-1" pitch="@0" yaw="@180"/>
    <portal forward="all(current_stage=4,spawn_seed=2)" destination="stage-4-spawn-2" pitch="@0" yaw="@180"/>

    <portal forward="all(current_stage=5,spawn_seed=1)" destination="stage-5-spawn-1" pitch="@0" yaw="@-90"/>
    <portal forward="all(current_stage=5,spawn_seed=2)" destination="stage-5-spawn-2" pitch="@0" yaw="@90"/>

    <portal forward="all(current_stage=6,spawn_seed=1)" destination="stage-6-spawn-1" pitch="@0" yaw="@-45"/>
    <portal forward="all(current_stage=6,spawn_seed=2)" destination="stage-6-spawn-2" pitch="@0" yaw="@135"/>

    <portal forward="all(current_stage=7,spawn_seed=1)" destination="stage-7-spawn-1" pitch="@0" yaw="@-90"/>
    <portal forward="all(current_stage=7,spawn_seed=2)" destination="stage-7-spawn-2" pitch="@0" yaw="@-90"/>

    <portal forward="all(current_stage=8,spawn_seed=1)" destination="stage-8-spawn-1" pitch="@0" yaw="@0"/>
    <portal forward="all(current_stage=8,spawn_seed=2)" destination="stage-8-spawn-2" pitch="@0" yaw="@180"/>

    <portal forward="all(current_stage=9,spawn_seed=1)" destination="stage-9-spawn-1" pitch="@0" yaw="@-45"/>
    <portal forward="all(current_stage=9,spawn_seed=2)" destination="stage-9-spawn-2" pitch="@0" yaw="@45"/>

    <portal forward="all(current_stage=10,spawn_seed=1)" destination="stage-10-spawn-1" pitch="@0" yaw="@90"/>
    <portal forward="all(current_stage=10,spawn_seed=2)" destination="stage-10-spawn-2" pitch="@0" yaw="@-90"/>

    <portal forward="all(current_stage=11,spawn_seed=1)" destination="stage-11-spawn-1" pitch="@0" yaw="@0"/>
    <portal forward="all(current_stage=11,spawn_seed=2)" destination="stage-11-spawn-2" pitch="@0" yaw="@180"/>

    <portal forward="current_stage=12" destination="stage-12-spawn" pitch="@0" yaw="@135"/>

    <portal forward="all(current_stage=13,spawn_seed=1)" destination="stage-13-spawn-1" pitch="@0" yaw="@-135"/>
    <portal forward="all(current_stage=13,spawn_seed=2)" destination="stage-13-spawn-2" pitch="@0" yaw="@45"/>

    <portal forward="all(current_stage=14,spawn_seed=1)" destination="stage-14-spawn-1" pitch="@0" yaw="@-90"/>
    <portal forward="all(current_stage=14,spawn_seed=2)" destination="stage-14-spawn-2" pitch="@0" yaw="@90"/>

    <portal forward="all(current_stage=15,spawn_seed=1)" destination="stage-15-spawn-1" pitch="@0" yaw="@90"/>
    <portal forward="all(current_stage=15,spawn_seed=2)" destination="stage-15-spawn-2" pitch="@0" yaw="@180"/>

    <portal forward="all(current_stage=16,spawn_seed=1)" destination="stage-16-spawn-1" pitch="@0" yaw="@0"/>
    <portal forward="all(current_stage=16,spawn_seed=2)" destination="stage-16-spawn-2" pitch="@0" yaw="@180"/>
</portals>
<variables scope="match">
    <array id="button_placer" size="4"/>
    <variable id="last_stage_played"/>
    <variable id="someone_won"/>
    <variable id="should_finish"/>
    <!-- 
    buttons arrays
    [0 = amount, 1 = x, 2 = y, 3 = z, 4 = r, x, y, z, r, ...]
    index 0 → number of buttons
    then each button → 4 values (x, y, z, rotation)
    -->
    <array id="stage_0_buttons" size="13"/>
    <variable id="stage_0_selected_button"/>
    <array id="stage_1_buttons" size="17"/>
    <variable id="stage_1_selected_button"/>
    <array id="stage_2_buttons" size="21"/>
    <variable id="stage_2_selected_button"/>
    <array id="stage_3_buttons" size="21"/>
    <variable id="stage_3_selected_button"/>
    <array id="stage_4_buttons" size="21"/>
    <variable id="stage_4_selected_button"/>
    <array id="stage_5_buttons" size="21"/>
    <variable id="stage_5_selected_button"/>
    <array id="stage_6_buttons" size="25"/>
    <variable id="stage_6_selected_button"/>
    <array id="stage_7_buttons" size="29"/>
    <variable id="stage_7_selected_button"/>
    <array id="stage_8_buttons" size="25"/>
    <variable id="stage_8_selected_button"/>
    <array id="stage_9_buttons" size="25"/>
    <variable id="stage_9_selected_button"/>
    <array id="stage_10_buttons" size="21"/>
    <variable id="stage_10_selected_button"/>
    <array id="stage_11_buttons" size="17"/>
    <variable id="stage_11_selected_button"/>
    <array id="stage_12_buttons" size="25"/>
    <variable id="stage_12_selected_button"/>
    <array id="stage_13_buttons" size="21"/>
    <variable id="stage_13_selected_button"/>
    <array id="stage_14_buttons" size="17"/>
    <variable id="stage_14_selected_button"/>
    <array id="stage_15_buttons" size="21"/>
    <variable id="stage_15_selected_button"/>
    <array id="stage_16_buttons" size="25"/>
    <variable id="stage_16_selected_button"/>
    <!-- debug -->
    <variable id="show_hint"/>
</variables>
<variables scope="player">
    <variable id="just_changed_stage" default="1"/>
    <variable id="did_win"/>
    <variable id="current_stage"/>
    <variable id="spawn_seed"/>
    <variable id="calc_x"/>
    <variable id="calc_y"/>
    <variable id="calc_z"/>
    <variable id="is_looking_at_button"/>
    <array id="current_stage_button" size="3"/>
    <variable id="last_player_that_pressed" exclusive="1"/>
</variables>
<actions>
    <!-- initial stuff -->
    <trigger scope="player" filter="always" action="spawn_seed:=floor(random() * 2) + 1"/>
    <trigger scope="match" filter="always">
        <action>
            <!-- register button positions -->
            <!-- stage 0 -->
            <set var="stage_0_buttons" index="0" value="3"/>      <!-- amount -->
            <!-- button 1 -->
            <set var="stage_0_buttons" index="1" value="-128.5"/> <!-- x -->
            <set var="stage_0_buttons" index="2" value="8"/>      <!-- y -->
            <set var="stage_0_buttons" index="3" value="58.5"/>   <!-- z -->
            <set var="stage_0_buttons" index="4" value="3"/>      <!-- rotation -->
            <!-- button 2 -->
            <set var="stage_0_buttons" index="5" value="-129.5"/>
            <set var="stage_0_buttons" index="6" value="4"/>
            <set var="stage_0_buttons" index="7" value="43.5"/> 
            <set var="stage_0_buttons" index="8" value="1"/>
            <!-- button 3 -->
            <set var="stage_0_buttons" index="9" value="-89.5"/> 
            <set var="stage_0_buttons" index="10" value="8"/>
            <set var="stage_0_buttons" index="11" value="43.5"/>
            <set var="stage_0_buttons" index="12" value="3"/>
            
            <!-- stage 1 -->
            <set var="stage_1_buttons" index="0" value="4"/>
            <!-- button 1 -->
            <set var="stage_1_buttons" index="1" value="-65.5"/> 
            <set var="stage_1_buttons" index="2" value="9"/>
            <set var="stage_1_buttons" index="3" value="66.5"/>
            <set var="stage_1_buttons" index="4" value="1"/>
            <!-- button 2 -->
            <set var="stage_1_buttons" index="5" value="-85.5"/> 
            <set var="stage_1_buttons" index="6" value="4"/>
            <set var="stage_1_buttons" index="7" value="71.5"/>
            <set var="stage_1_buttons" index="8" value="4"/>
            <!-- button 3 -->
            <set var="stage_1_buttons" index="9" value="-78.5"/> 
            <set var="stage_1_buttons" index="10" value="8"/>
            <set var="stage_1_buttons" index="11" value="66.5"/>
            <set var="stage_1_buttons" index="12" value="2"/>
            <!-- button 4 -->
            <set var="stage_1_buttons" index="13" value="-68.5"/>
            <set var="stage_1_buttons" index="14" value="5"/>
            <set var="stage_1_buttons" index="15" value="75.5"/>
            <set var="stage_1_buttons" index="16" value="1"/>

            <!-- stage 2 -->
            <set var="stage_2_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_2_buttons" index="1" value="-81.5"/>
            <set var="stage_2_buttons" index="2" value="6"/>
            <set var="stage_2_buttons" index="3" value="44.5"/>
            <set var="stage_2_buttons" index="4" value="1"/>
            <!-- button 2 -->
            <set var="stage_2_buttons" index="5" value="-69.5"/>
            <set var="stage_2_buttons" index="6" value="4"/>
            <set var="stage_2_buttons" index="7" value="44.5"/>
            <set var="stage_2_buttons" index="8" value="4"/>
            <!-- button 3 -->
            <set var="stage_2_buttons" index="9" value="-66.5"/>
            <set var="stage_2_buttons" index="10" value="6"/>
            <set var="stage_2_buttons" index="11" value="54.5"/>
            <set var="stage_2_buttons" index="12" value="1"/>
            <!-- button 4 -->
            <set var="stage_2_buttons" index="13" value="-68.5"/>
            <set var="stage_2_buttons" index="14" value="5"/>
            <set var="stage_2_buttons" index="15" value="50.5"/>
            <set var="stage_2_buttons" index="16" value="1"/>
            <!-- button 5 -->
            <set var="stage_2_buttons" index="17" value="-84.5"/>
            <set var="stage_2_buttons" index="18" value="9"/>
            <set var="stage_2_buttons" index="19" value="54.5"/>
            <set var="stage_2_buttons" index="20" value="1"/>

            <!-- stage 3 -->
            <set var="stage_3_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_3_buttons" index="1" value="-67.5"/>
            <set var="stage_3_buttons" index="2" value="8"/>
            <set var="stage_3_buttons" index="3" value="32.5"/>
            <set var="stage_3_buttons" index="4" value="4"/>
            <!-- button 2 -->
            <set var="stage_3_buttons" index="5" value="-67.5"/>
            <set var="stage_3_buttons" index="6" value="7"/>
            <set var="stage_3_buttons" index="7" value="25.5"/>
            <set var="stage_3_buttons" index="8" value="1"/>
            <!-- button 3 -->
            <set var="stage_3_buttons" index="9" value="-65.5"/>
            <set var="stage_3_buttons" index="10" value="6"/>
            <set var="stage_3_buttons" index="11" value="22.5"/>
            <set var="stage_3_buttons" index="12" value="0"/>
            <!-- button 4 -->
            <set var="stage_3_buttons" index="13" value="-73.5"/>
            <set var="stage_3_buttons" index="14" value="4"/>
            <set var="stage_3_buttons" index="15" value="22.5"/>
            <set var="stage_3_buttons" index="16" value="4"/>
            <!-- button 5 -->
            <set var="stage_3_buttons" index="17" value="-68.5"/>
            <set var="stage_3_buttons" index="18" value="4"/>
            <set var="stage_3_buttons" index="19" value="42.5"/>
            <set var="stage_3_buttons" index="20" value="3"/>

            <!-- stage 4 -->
            <set var="stage_4_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_4_buttons" index="1" value="-80.5"/>
            <set var="stage_4_buttons" index="2" value="5"/>
            <set var="stage_4_buttons" index="3" value="9.5"/>
            <set var="stage_4_buttons" index="4" value="3"/>
            <!-- button 2 -->
            <set var="stage_4_buttons" index="5" value="-69.5"/>
            <set var="stage_4_buttons" index="6" value="5"/>
            <set var="stage_4_buttons" index="7" value="5.5"/>
            <set var="stage_4_buttons" index="8" value="4"/>
            <!-- button 3 -->
            <set var="stage_4_buttons" index="9" value="-69.5"/>
            <set var="stage_4_buttons" index="10" value="6"/>
            <set var="stage_4_buttons" index="11" value="19.5"/>
            <set var="stage_4_buttons" index="12" value="0"/>
            <!-- button 4 -->
            <set var="stage_4_buttons" index="13" value="-83.5"/>
            <set var="stage_4_buttons" index="14" value="5"/>
            <set var="stage_4_buttons" index="15" value="10.5"/>
            <set var="stage_4_buttons" index="16" value="2"/>
            <!-- button 5 -->
            <set var="stage_4_buttons" index="17" value="-65.5"/>
            <set var="stage_4_buttons" index="18" value="9"/>
            <set var="stage_4_buttons" index="19" value="4.5"/>
            <set var="stage_4_buttons" index="20" value="4"/>

            <!-- stage 5 -->
            <set var="stage_5_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_5_buttons" index="1" value="-45.5"/>
            <set var="stage_5_buttons" index="2" value="11"/>
            <set var="stage_5_buttons" index="3" value="4.5"/>
            <set var="stage_5_buttons" index="4" value="3"/>
            <!-- button 2 -->
            <set var="stage_5_buttons" index="5" value="-44.5"/>
            <set var="stage_5_buttons" index="6" value="9"/>
            <set var="stage_5_buttons" index="7" value="9.5"/>
            <set var="stage_5_buttons" index="8" value="2"/>
            <!-- button 3 -->
            <set var="stage_5_buttons" index="9" value="-48.5"/>
            <set var="stage_5_buttons" index="10" value="3"/>
            <set var="stage_5_buttons" index="11" value="17.5"/>
            <set var="stage_5_buttons" index="12" value="5"/>
            <!-- button 4 -->
            <set var="stage_5_buttons" index="13" value="-48.5"/>
            <set var="stage_5_buttons" index="14" value="5"/>
            <set var="stage_5_buttons" index="15" value="3.5"/>
            <set var="stage_5_buttons" index="16" value="0"/>
            <!-- button 5 -->
            <set var="stage_5_buttons" index="17" value="-54.5"/>
            <set var="stage_5_buttons" index="18" value="5"/>
            <set var="stage_5_buttons" index="19" value="9.5"/>
            <set var="stage_5_buttons" index="20" value="3"/>

            <!-- stage 6 -->
            <set var="stage_6_buttons" index="0" value="6"/>
            <!-- button 1 -->
            <set var="stage_6_buttons" index="1" value="-51.5"/>
            <set var="stage_6_buttons" index="2" value="6"/>
            <set var="stage_6_buttons" index="3" value="30.5"/>
            <set var="stage_6_buttons" index="4" value="3"/>
            <!-- button 2 -->
            <set var="stage_6_buttons" index="5" value="-49.5"/>
            <set var="stage_6_buttons" index="6" value="8"/>
            <set var="stage_6_buttons" index="7" value="28.5"/>
            <set var="stage_6_buttons" index="8" value="0"/>
            <!-- button 3 -->
            <set var="stage_6_buttons" index="9" value="-48.5"/>
            <set var="stage_6_buttons" index="10" value="6"/>
            <set var="stage_6_buttons" index="11" value="30.5"/>
            <set var="stage_6_buttons" index="12" value="3"/>
            <!-- button 4 -->
            <set var="stage_6_buttons" index="13" value="-44.5"/>
            <set var="stage_6_buttons" index="14" value="2"/>
            <set var="stage_6_buttons" index="15" value="36.5"/>
            <set var="stage_6_buttons" index="16" value="3"/>
            <!-- button 5 -->
            <set var="stage_6_buttons" index="17" value="-62.5"/>
            <set var="stage_6_buttons" index="18" value="2"/>
            <set var="stage_6_buttons" index="19" value="30.5"/>
            <set var="stage_6_buttons" index="20" value="3"/>
            <!-- button 6 -->
            <set var="stage_6_buttons" index="21" value="-51.5"/>
            <set var="stage_6_buttons" index="22" value="2"/>
            <set var="stage_6_buttons" index="23" value="34.5"/>
            <set var="stage_6_buttons" index="24" value="4"/>

            <!-- stage 7 -->
            <set var="stage_7_buttons" index="0" value="7"/>
            <!-- button 1 -->
            <set var="stage_7_buttons" index="1" value="-45.5"/>
            <set var="stage_7_buttons" index="2" value="4"/>
            <set var="stage_7_buttons" index="3" value="50.5"/>
            <set var="stage_7_buttons" index="4" value="1"/>
            <!-- button 2 -->
            <set var="stage_7_buttons" index="5" value="-46.5"/>
            <set var="stage_7_buttons" index="6" value="4"/>
            <set var="stage_7_buttons" index="7" value="56.5"/>
            <set var="stage_7_buttons" index="8" value="1"/>
            <!-- button 3 -->
            <set var="stage_7_buttons" index="9" value="-46.5"/>
            <set var="stage_7_buttons" index="10" value="6"/>
            <set var="stage_7_buttons" index="11" value="64.5"/>
            <set var="stage_7_buttons" index="12" value="1"/>
            <!-- button 4 -->
            <set var="stage_7_buttons" index="13" value="-59.5"/>
            <set var="stage_7_buttons" index="14" value="9"/>
            <set var="stage_7_buttons" index="15" value="64.5"/>
            <set var="stage_7_buttons" index="16" value="0"/>
            <!-- button 5 -->
            <set var="stage_7_buttons" index="17" value="-44.5"/>
            <set var="stage_7_buttons" index="18" value="12"/>
            <set var="stage_7_buttons" index="19" value="61.5"/>
            <set var="stage_7_buttons" index="20" value="1"/>
            <!-- button 6 -->
            <set var="stage_7_buttons" index="21" value="-60.5"/>
            <set var="stage_7_buttons" index="22" value="12"/>
            <set var="stage_7_buttons" index="23" value="45.5"/>
            <set var="stage_7_buttons" index="24" value="2"/>
            <!-- button 7 -->
            <set var="stage_7_buttons" index="25" value="-54.5"/>
            <set var="stage_7_buttons" index="26" value="10"/>
            <set var="stage_7_buttons" index="27" value="44.5"/>
            <set var="stage_7_buttons" index="28" value="2"/>

            <!-- stage 8 -->
            <set var="stage_8_buttons" index="0" value="6"/>
            <!-- button 1 -->
            <set var="stage_8_buttons" index="1" value="-43.5"/>
            <set var="stage_8_buttons" index="2" value="9"/>
            <set var="stage_8_buttons" index="3" value="86.5"/>
            <set var="stage_8_buttons" index="4" value="1"/>
            <!-- button 2 -->
            <set var="stage_8_buttons" index="5" value="-62.5"/>
            <set var="stage_8_buttons" index="6" value="7"/>
            <set var="stage_8_buttons" index="7" value="67.5"/>
            <set var="stage_8_buttons" index="8" value="2"/>
            <!-- button 3 -->
            <set var="stage_8_buttons" index="9" value="-45.5"/>
            <set var="stage_8_buttons" index="10" value="3"/>
            <set var="stage_8_buttons" index="11" value="81.5"/>
            <set var="stage_8_buttons" index="12" value="1"/>
            <!-- button 4 -->
            <set var="stage_8_buttons" index="13" value="-54.5"/>
            <set var="stage_8_buttons" index="14" value="3"/>
            <set var="stage_8_buttons" index="15" value="86.5"/>
            <set var="stage_8_buttons" index="16" value="3"/>
            <!-- button 5 -->
            <set var="stage_8_buttons" index="17" value="-62.5"/>
            <set var="stage_8_buttons" index="18" value="4"/>
            <set var="stage_8_buttons" index="19" value="81.5"/>
            <set var="stage_8_buttons" index="20" value="0"/>
            <!-- button 6 -->
            <set var="stage_8_buttons" index="21" value="-57.5"/>
            <set var="stage_8_buttons" index="22" value="6"/>
            <set var="stage_8_buttons" index="23" value="67.5"/>
            <set var="stage_8_buttons" index="24" value="4"/>

            <!-- stage 9 -->
            <set var="stage_9_buttons" index="0" value="6"/>
            <!-- button 1 -->
            <set var="stage_9_buttons" index="1" value="-35.5"/>
            <set var="stage_9_buttons" index="2" value="4"/>
            <set var="stage_9_buttons" index="3" value="79.5"/>
            <set var="stage_9_buttons" index="4" value="1"/>
            <!-- button 2 -->
            <set var="stage_9_buttons" index="5" value="-41.5"/>
            <set var="stage_9_buttons" index="6" value="7"/>
            <set var="stage_9_buttons" index="7" value="86.5"/>
            <set var="stage_9_buttons" index="8" value="2"/>
            <!-- button 3 -->
            <set var="stage_9_buttons" index="9" value="-25.5"/>
            <set var="stage_9_buttons" index="10" value="6"/>
            <set var="stage_9_buttons" index="11" value="86.5"/>
            <set var="stage_9_buttons" index="12" value="2"/>
            <!-- button 4 -->
            <set var="stage_9_buttons" index="13" value="-23.5"/>
            <set var="stage_9_buttons" index="14" value="3"/>
            <set var="stage_9_buttons" index="15" value="77.5"/>
            <set var="stage_9_buttons" index="16" value="1"/>
            <!-- button 5 -->
            <set var="stage_9_buttons" index="17" value="-26.5"/>
            <set var="stage_9_buttons" index="18" value="3"/>
            <set var="stage_9_buttons" index="19" value="71.5"/>
            <set var="stage_9_buttons" index="20" value="3"/>
            <!-- button 6 -->
            <set var="stage_9_buttons" index="21" value="-41.5"/>
            <set var="stage_9_buttons" index="22" value="11"/>
            <set var="stage_9_buttons" index="23" value="67.5"/>
            <set var="stage_9_buttons" index="24" value="5"/>

            <!-- stage 10 -->
            <set var="stage_10_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_10_buttons" index="1" value="-32.5"/>
            <set var="stage_10_buttons" index="2" value="10"/>
            <set var="stage_10_buttons" index="3" value="64.5"/>
            <set var="stage_10_buttons" index="4" value="3"/>
            <!-- button 2 -->
            <set var="stage_10_buttons" index="5" value="-40.5"/>
            <set var="stage_10_buttons" index="6" value="9"/>
            <set var="stage_10_buttons" index="7" value="55.5"/>
            <set var="stage_10_buttons" index="8" value="2"/>
            <!-- button 3 -->
            <set var="stage_10_buttons" index="9" value="-23.5"/>
            <set var="stage_10_buttons" index="10" value="8"/>
            <set var="stage_10_buttons" index="11" value="49.5"/>
            <set var="stage_10_buttons" index="12" value="1"/>
            <!-- button 4 -->
            <set var="stage_10_buttons" index="13" value="-38.5"/>
            <set var="stage_10_buttons" index="14" value="4"/>
            <set var="stage_10_buttons" index="15" value="49.5"/>
            <set var="stage_10_buttons" index="16" value="4"/>
            <!-- button 5 -->
            <set var="stage_10_buttons" index="17" value="-33.5"/>
            <set var="stage_10_buttons" index="18" value="3"/>
            <set var="stage_10_buttons" index="19" value="61.5"/>
            <set var="stage_10_buttons" index="20" value="2"/>

            <!-- stage 11 -->
            <set var="stage_11_buttons" index="0" value="4"/>
            <!-- button 1 -->
            <set var="stage_11_buttons" index="1" value="-41.5"/>
            <set var="stage_11_buttons" index="2" value="8"/>
            <set var="stage_11_buttons" index="3" value="42.5"/>
            <set var="stage_11_buttons" index="4" value="5"/>
            <!-- button 2 -->
            <set var="stage_11_buttons" index="5" value="-34.5"/>
            <set var="stage_11_buttons" index="6" value="6"/>
            <set var="stage_11_buttons" index="7" value="28.5"/>
            <set var="stage_11_buttons" index="8" value="3"/>
            <!-- button 3 -->
            <set var="stage_11_buttons" index="9" value="-31.5"/>
            <set var="stage_11_buttons" index="10" value="9"/>
            <set var="stage_11_buttons" index="11" value="22.5"/>
            <set var="stage_11_buttons" index="12" value="3"/>
            <!-- button 4 -->
            <set var="stage_11_buttons" index="13" value="-21.5"/>
            <set var="stage_11_buttons" index="14" value="6"/>
            <set var="stage_11_buttons" index="15" value="41.5"/>
            <set var="stage_11_buttons" index="16" value="1"/>

            <!-- stage 12 -->
            <set var="stage_12_buttons" index="0" value="6"/>
            <!-- button 1 -->
            <set var="stage_12_buttons" index="1" value="-35.5"/>
            <set var="stage_12_buttons" index="2" value="3"/>
            <set var="stage_12_buttons" index="3" value="20.5"/>
            <set var="stage_12_buttons" index="4" value="0"/>
            <!-- button 2 -->
            <set var="stage_12_buttons" index="5" value="-32.5"/>
            <set var="stage_12_buttons" index="6" value="2"/>
            <set var="stage_12_buttons" index="7" value="1.5"/>
            <set var="stage_12_buttons" index="8" value="4"/>
            <!-- button 3 -->
            <set var="stage_12_buttons" index="9" value="-38.5"/>
            <set var="stage_12_buttons" index="10" value="2"/>
            <set var="stage_12_buttons" index="11" value="7.5"/>
            <set var="stage_12_buttons" index="12" value="4"/>
            <!-- button 4 -->
            <set var="stage_12_buttons" index="13" value="-36.5"/>
            <set var="stage_12_buttons" index="14" value="4"/>
            <set var="stage_12_buttons" index="15" value="17.5"/>
            <set var="stage_12_buttons" index="16" value="2"/>
            <!-- button 5 -->
            <set var="stage_12_buttons" index="17" value="-21.5"/>
            <set var="stage_12_buttons" index="18" value="4"/>
            <set var="stage_12_buttons" index="19" value="16.5"/>
            <set var="stage_12_buttons" index="20" value="4"/>
            <!-- button 6 -->
            <set var="stage_12_buttons" index="21" value="-36.5"/>
            <set var="stage_12_buttons" index="22" value="7"/>
            <set var="stage_12_buttons" index="23" value="3.5"/>
            <set var="stage_12_buttons" index="24" value="4"/>

            <!-- stage 13 -->
            <set var="stage_13_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_13_buttons" index="1" value="-16.5"/>
            <set var="stage_13_buttons" index="2" value="4"/>
            <set var="stage_13_buttons" index="3" value="15.5"/>
            <set var="stage_13_buttons" index="4" value="4"/>
            <!-- button 2 -->
            <set var="stage_13_buttons" index="5" value="-6.5"/>
            <set var="stage_13_buttons" index="6" value="4"/>
            <set var="stage_13_buttons" index="7" value="8.5"/>
            <set var="stage_13_buttons" index="8" value="3"/>
            <!-- button 3 -->
            <set var="stage_13_buttons" index="9" value="-11.5"/>
            <set var="stage_13_buttons" index="10" value="6"/>
            <set var="stage_13_buttons" index="11" value="1.5"/>
            <set var="stage_13_buttons" index="12" value="4"/>
            <!-- button 4 -->
            <set var="stage_13_buttons" index="13" value="-10.5"/>
            <set var="stage_13_buttons" index="14" value="5"/>
            <set var="stage_13_buttons" index="15" value="20.5"/>
            <set var="stage_13_buttons" index="16" value="1"/>
            <!-- button 5 -->
            <set var="stage_13_buttons" index="17" value="-10.5"/>
            <set var="stage_13_buttons" index="18" value="5"/>
            <set var="stage_13_buttons" index="19" value="11.5"/>
            <set var="stage_13_buttons" index="20" value="5"/>

            <!-- stage 14 -->
            <set var="stage_14_buttons" index="0" value="4"/>
            <!-- button 1 -->
            <set var="stage_14_buttons" index="1" value="-18.5"/>
            <set var="stage_14_buttons" index="2" value="4"/>
            <set var="stage_14_buttons" index="3" value="29.5"/>
            <set var="stage_14_buttons" index="4" value="4"/>
            <!-- button 2 -->
            <set var="stage_14_buttons" index="5" value="0.5"/>
            <set var="stage_14_buttons" index="6" value="9"/>
            <set var="stage_14_buttons" index="7" value="24.5"/>
            <set var="stage_14_buttons" index="8" value="4"/>
            <!-- button 3 -->
            <set var="stage_14_buttons" index="9" value="-5.5"/>
            <set var="stage_14_buttons" index="10" value="11"/>
            <set var="stage_14_buttons" index="11" value="29.5"/>
            <set var="stage_14_buttons" index="12" value="1"/>
            <!-- button 4 -->
            <set var="stage_14_buttons" index="13" value="-10.5"/>
            <set var="stage_14_buttons" index="14" value="8"/>
            <set var="stage_14_buttons" index="15" value="42.5"/>
            <set var="stage_14_buttons" index="16" value="3"/>

            <!-- stage 15 -->
            <set var="stage_15_buttons" index="0" value="5"/>
            <!-- button 1 -->
            <set var="stage_15_buttons" index="1" value="-0.5"/>
            <set var="stage_15_buttons" index="2" value="6"/>
            <set var="stage_15_buttons" index="3" value="54.5"/>
            <set var="stage_15_buttons" index="4" value="3"/>
            <!-- button 2 -->
            <set var="stage_15_buttons" index="5" value="-2.5"/>
            <set var="stage_15_buttons" index="6" value="1"/>
            <set var="stage_15_buttons" index="7" value="60.5"/>
            <set var="stage_15_buttons" index="8" value="3"/>
            <!-- button 3 -->
            <set var="stage_15_buttons" index="9" value="-14.5"/>
            <set var="stage_15_buttons" index="10" value="4"/>
            <set var="stage_15_buttons" index="11" value="51.5"/>
            <set var="stage_15_buttons" index="12" value="3"/>
            <!-- button 4 -->
            <set var="stage_15_buttons" index="13" value="-15.5"/>
            <set var="stage_15_buttons" index="14" value="5"/>
            <set var="stage_15_buttons" index="15" value="61.5"/>
            <set var="stage_15_buttons" index="16" value="0"/>
            <!-- button 5 -->
            <set var="stage_15_buttons" index="17" value="-19.5"/>
            <set var="stage_15_buttons" index="18" value="8"/>
            <set var="stage_15_buttons" index="19" value="63.5"/>
            <set var="stage_15_buttons" index="20" value="2"/>

            <!-- stage 16 -->
            <set var="stage_16_buttons" index="0" value="6"/>
            <!-- button 1 -->
            <set var="stage_16_buttons" index="1" value="-7.5"/>
            <set var="stage_16_buttons" index="2" value="3"/>
            <set var="stage_16_buttons" index="3" value="82.5"/>
            <set var="stage_16_buttons" index="4" value="3"/>
            <!-- button 2 -->
            <set var="stage_16_buttons" index="5" value="-13.5"/>
            <set var="stage_16_buttons" index="6" value="6"/>
            <set var="stage_16_buttons" index="7" value="85.5"/>
            <set var="stage_16_buttons" index="8" value="1"/>
            <!-- button 3 -->
            <set var="stage_16_buttons" index="9" value="-18.5"/>
            <set var="stage_16_buttons" index="10" value="4"/>
            <set var="stage_16_buttons" index="11" value="84.5"/>
            <set var="stage_16_buttons" index="12" value="3"/>
            <!-- button 4 -->
            <set var="stage_16_buttons" index="13" value="-18.5"/>
            <set var="stage_16_buttons" index="14" value="8"/>
            <set var="stage_16_buttons" index="15" value="74.5"/>
            <set var="stage_16_buttons" index="16" value="2"/>
            <!-- button 5 -->
            <set var="stage_16_buttons" index="17" value="-7.5"/>
            <set var="stage_16_buttons" index="18" value="9"/>
            <set var="stage_16_buttons" index="19" value="66.5"/>
            <set var="stage_16_buttons" index="20" value="1"/>
            <!-- button 6 -->
            <set var="stage_16_buttons" index="21" value="-9.5"/>
            <set var="stage_16_buttons" index="22" value="14"/>
            <set var="stage_16_buttons" index="23" value="67.5"/>
            <set var="stage_16_buttons" index="24" value="5"/>

            <!-- select random buttons -->
            <set var="stage_0_selected_button" value="1 + ((floor(random() * stage_0_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_1_selected_button" value="1 + ((floor(random() * stage_1_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_2_selected_button" value="1 + ((floor(random() * stage_2_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_3_selected_button" value="1 + ((floor(random() * stage_3_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_4_selected_button" value="1 + ((floor(random() * stage_4_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_5_selected_button" value="1 + ((floor(random() * stage_5_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_6_selected_button" value="1 + ((floor(random() * stage_6_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_7_selected_button" value="1 + ((floor(random() * stage_7_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_8_selected_button" value="1 + ((floor(random() * stage_8_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_9_selected_button" value="1 + ((floor(random() * stage_9_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_10_selected_button" value="1 + ((floor(random() * stage_10_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_11_selected_button" value="1 + ((floor(random() * stage_11_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_12_selected_button" value="1 + ((floor(random() * stage_12_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_13_selected_button" value="1 + ((floor(random() * stage_13_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_14_selected_button" value="1 + ((floor(random() * stage_14_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_15_selected_button" value="1 + ((floor(random() * stage_15_buttons[0]) + 1) - 1) * 4"/>
            <set var="stage_16_selected_button" value="1 + ((floor(random() * stage_16_buttons[0]) + 1) - 1) * 4"/>
        </action>
    </trigger>
    <!-- place buttons -->
    <trigger scope="match" filter="match-started">
        <action>
            <set var="button_placer" index="0" value="stage_0_buttons[stage_0_selected_button]"/>
            <set var="button_placer" index="1" value="stage_0_buttons[stage_0_selected_button+1]+1"/>  <!-- +1 cause bug -->
            <set var="button_placer" index="2" value="stage_0_buttons[stage_0_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_0_buttons[stage_0_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_1_buttons[stage_1_selected_button]"/>
            <set var="button_placer" index="1" value="stage_1_buttons[stage_1_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_1_buttons[stage_1_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_1_buttons[stage_1_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_2_buttons[stage_2_selected_button]"/>
            <set var="button_placer" index="1" value="stage_2_buttons[stage_2_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_2_buttons[stage_2_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_2_buttons[stage_2_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_3_buttons[stage_3_selected_button]"/>
            <set var="button_placer" index="1" value="stage_3_buttons[stage_3_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_3_buttons[stage_3_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_3_buttons[stage_3_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_4_buttons[stage_4_selected_button]"/>
            <set var="button_placer" index="1" value="stage_4_buttons[stage_4_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_4_buttons[stage_4_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_4_buttons[stage_4_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_5_buttons[stage_5_selected_button]"/>
            <set var="button_placer" index="1" value="stage_5_buttons[stage_5_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_5_buttons[stage_5_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_5_buttons[stage_5_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_6_buttons[stage_6_selected_button]"/>
            <set var="button_placer" index="1" value="stage_6_buttons[stage_6_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_6_buttons[stage_6_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_6_buttons[stage_6_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_7_buttons[stage_7_selected_button]"/>
            <set var="button_placer" index="1" value="stage_7_buttons[stage_7_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_7_buttons[stage_7_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_7_buttons[stage_7_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_8_buttons[stage_8_selected_button]"/>
            <set var="button_placer" index="1" value="stage_8_buttons[stage_8_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_8_buttons[stage_8_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_8_buttons[stage_8_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_9_buttons[stage_9_selected_button]"/>
            <set var="button_placer" index="1" value="stage_9_buttons[stage_9_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_9_buttons[stage_9_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_9_buttons[stage_9_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_10_buttons[stage_10_selected_button]"/>
            <set var="button_placer" index="1" value="stage_10_buttons[stage_10_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_10_buttons[stage_10_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_10_buttons[stage_10_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_11_buttons[stage_11_selected_button]"/>
            <set var="button_placer" index="1" value="stage_11_buttons[stage_11_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_11_buttons[stage_11_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_11_buttons[stage_11_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_12_buttons[stage_12_selected_button]"/>
            <set var="button_placer" index="1" value="stage_12_buttons[stage_12_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_12_buttons[stage_12_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_12_buttons[stage_12_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_13_buttons[stage_13_selected_button]"/>
            <set var="button_placer" index="1" value="stage_13_buttons[stage_13_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_13_buttons[stage_13_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_13_buttons[stage_13_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_14_buttons[stage_14_selected_button]"/>
            <set var="button_placer" index="1" value="stage_14_buttons[stage_14_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_14_buttons[stage_14_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_14_buttons[stage_14_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_15_buttons[stage_15_selected_button]"/>
            <set var="button_placer" index="1" value="stage_15_buttons[stage_15_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_15_buttons[stage_15_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_15_buttons[stage_15_selected_button+3]"/>
            <action id="place-button"/>

            <set var="button_placer" index="0" value="stage_16_buttons[stage_16_selected_button]"/>
            <set var="button_placer" index="1" value="stage_16_buttons[stage_16_selected_button+1]+1"/>
            <set var="button_placer" index="2" value="stage_16_buttons[stage_16_selected_button+2]"/>
            <set var="button_placer" index="3" value="stage_16_buttons[stage_16_selected_button+3]"/>
            <action id="place-button"/>
        </action>
    </trigger>
    <!-- is player looking at button? -->
    <trigger scope="player">
        <filter>
            <pulse period="0.1s" duration="0.05s" filter="all(match-started,participating,not(crouching))"/>
        </filter>
        <action>
            <set var="calc_x" value="player.target_x-current_stage_button[0]"/>
            <set var="calc_y" value="player.target_y-current_stage_button[1]"/>
            <set var="calc_z" value="player.target_z-current_stage_button[2]"/>
            <action filter="show_hint=1">
                <message text="{0} {1} {2} {3}">
                    <replacements>
                        <decimal id="0" value="calc_x"/>
                        <decimal id="1" value="calc_y"/>
                        <decimal id="2" value="calc_z"/>
                        <decimal id="3" value="is_looking_at_button"/>
                    </replacements>
                </message>
            </action>
            <action filter="all(calc_x=0,calc_y=0,calc_z=0,is_looking_at_button=0)">
                <kit id="button-kit"/>
                <set var="is_looking_at_button" value="1"/>
            </action>
            <action filter="all(is_looking_at_button=1,any(not(calc_x=0),not(calc_y=0),not(calc_z=0)))">
                <kit id="empty-kit"/>
                <set var="is_looking_at_button" value="0"/>
            </action>
        </action>
    </trigger>
    <trigger scope="player" filter="all(crouching,participating)">
        <action>
            <message actionbar="`cYou can't press the button while crouching!"/>
        </action>
    </trigger>
    <!-- consumable action -->
    <action id="press-button" scope="player">
        <kit id="empty-kit"/>
        <set var="score" value="score + 1"/>
        <action filter="all(current_stage=16,someone_won=0)">
            <set var="someone_won" value="1"/>
            <set var="did_win" value="1"/>
        </action>
        <set var="current_stage" value="current_stage + 1"/>
        <action filter="current_stage=17">
            <message title="`eYou won!"/>
            <kit>
                <game-mode>spectator</game-mode>
            </kit>
        </action>
        <set var="last_stage_played" value="current_stage"/>
        <set var="just_changed_stage" value="1"/>
    </action>
    <!-- register where the button is for player-scope -->
    <trigger scope="player" action="just_changed_stage:=0">
        <filter>
            <after duration="2s" filter="all(just_changed_stage=1,match-started)"/>
        </filter>
    </trigger>
    <trigger scope="player" filter="all(participating,just_changed_stage=1)">
        <action>
            <action filter="current_stage=0">
                <set var="current_stage_button" index="0" value="stage_0_buttons[stage_0_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_0_buttons[stage_0_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_0_buttons[stage_0_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=1">
                <set var="current_stage_button" index="0" value="stage_1_buttons[stage_1_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_1_buttons[stage_1_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_1_buttons[stage_1_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=0">
                <set var="current_stage_button" index="0" value="stage_0_buttons[stage_0_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_0_buttons[stage_0_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_0_buttons[stage_0_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=1">
                <set var="current_stage_button" index="0" value="stage_1_buttons[stage_1_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_1_buttons[stage_1_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_1_buttons[stage_1_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=2">
                <set var="current_stage_button" index="0" value="stage_2_buttons[stage_2_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_2_buttons[stage_2_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_2_buttons[stage_2_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=3">
                <set var="current_stage_button" index="0" value="stage_3_buttons[stage_3_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_3_buttons[stage_3_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_3_buttons[stage_3_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=4">
                <set var="current_stage_button" index="0" value="stage_4_buttons[stage_4_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_4_buttons[stage_4_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_4_buttons[stage_4_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=5">
                <set var="current_stage_button" index="0" value="stage_5_buttons[stage_5_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_5_buttons[stage_5_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_5_buttons[stage_5_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=6">
                <set var="current_stage_button" index="0" value="stage_6_buttons[stage_6_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_6_buttons[stage_6_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_6_buttons[stage_6_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=7">
                <set var="current_stage_button" index="0" value="stage_7_buttons[stage_7_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_7_buttons[stage_7_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_7_buttons[stage_7_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=8">
                <set var="current_stage_button" index="0" value="stage_8_buttons[stage_8_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_8_buttons[stage_8_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_8_buttons[stage_8_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=9">
                <set var="current_stage_button" index="0" value="stage_9_buttons[stage_9_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_9_buttons[stage_9_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_9_buttons[stage_9_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=10">
                <set var="current_stage_button" index="0" value="stage_10_buttons[stage_10_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_10_buttons[stage_10_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_10_buttons[stage_10_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=11">
                <set var="current_stage_button" index="0" value="stage_11_buttons[stage_11_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_11_buttons[stage_11_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_11_buttons[stage_11_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=12">
                <set var="current_stage_button" index="0" value="stage_12_buttons[stage_12_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_12_buttons[stage_12_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_12_buttons[stage_12_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=13">
                <set var="current_stage_button" index="0" value="stage_13_buttons[stage_13_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_13_buttons[stage_13_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_13_buttons[stage_13_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=14">
                <set var="current_stage_button" index="0" value="stage_14_buttons[stage_14_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_14_buttons[stage_14_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_14_buttons[stage_14_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=15">
                <set var="current_stage_button" index="0" value="stage_15_buttons[stage_15_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_15_buttons[stage_15_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_15_buttons[stage_15_selected_button+2] - 0.5"/>
            </action>
            <action filter="current_stage=16">
                <set var="current_stage_button" index="0" value="stage_16_buttons[stage_16_selected_button] - 0.5"/>
                <set var="current_stage_button" index="1" value="stage_16_buttons[stage_16_selected_button+1]"/>
                <set var="current_stage_button" index="2" value="stage_16_buttons[stage_16_selected_button+2] - 0.5"/>
            </action>
        </action>
    </trigger>
    <!-- button placing -->
    <action id="place-button" scope="match" expose="true">
        <action filter="button_placer[3]=0">
            <paste-structure x="button_placer[0]" y="button_placer[1]" z="button_placer[2]" structure="button-up" update="false"/>
        </action>
        <action filter="button_placer[3]=1">
            <paste-structure x="button_placer[0]" y="button_placer[1]" z="button_placer[2]" structure="button-west" update="false"/>
        </action>
        <action filter="button_placer[3]=2">
            <paste-structure x="button_placer[0]" y="button_placer[1]" z="button_placer[2]" structure="button-east" update="false"/>
        </action>
        <action filter="button_placer[3]=3">
            <paste-structure x="button_placer[0]" y="button_placer[1]" z="button_placer[2]" structure="button-north" update="false"/>
        </action>
        <action filter="button_placer[3]=4">
            <paste-structure x="button_placer[0]" y="button_placer[1]" z="button_placer[2]" structure="button-south" update="false"/>
        </action>
        <action filter="button_placer[3]=5">
            <paste-structure x="button_placer[0]" y="button_placer[1]" z="button_placer[2]" structure="button-down" update="false"/>
        </action>
    </action>
    <!-- messages -->
    <trigger scope="player" filter="just_changed_stage=1">
        <action>
            <set var="last_player_that_pressed" value="1"/>
            <action filter="current_stage=1..">
                <switch-scope inner="match">
                    <message text="{p} has found the button in `a{n}!">
                        <replacements>
                            <player id="p" var="last_player_that_pressed"/>
                            <switch id="n" value="last_stage_played - 1">
                                <case match="0" result="2014 Lobby"/>
                                <case match="1" result="The Fenland"/>
                                <case match="2" result="Snowy Wars"/>
                                <case match="3" result="Sunrise Over Paradise"/>
                                <case match="4" result="Long Shot"/>
                                <case match="5" result="Warlock"/>
                                <case match="6" result="101 Rooms"/>
                                <case match="7" result="Spaceship Battles"/>
                                <case match="8" result="Fractal Descent"/>
                                <case match="9" result="Monument Valley"/>
                                <case match="10" result="Balloons DTM"/>
                                <case match="11" result="Cargo"/>
                                <case match="12" result="BoomBox"/>
                                <case match="13" result="Golden Drought"/>
                                <case match="14" result="Directrix"/>
                                <case match="15" result="Hot Dam"/>
                                <case match="16" result="Canopy"/>
                            </switch>
                        </replacements>
                    </message>
                </switch-scope>
            </action>
            <action filter="current_stage=0..16">
                <message title="`e`lStage {s}" subtitle="`a{n}">
                    <replacements>
                        <decimal id="s" value="current_stage"/>
                        <switch id="n" value="current_stage">
                            <case match="0" result="2014 Lobby"/>
                            <case match="1" result="The Fenland"/>
                            <case match="2" result="Snowy Wars"/>
                            <case match="3" result="Sunrise Over Paradise"/>
                            <case match="4" result="Long Shot"/>
                            <case match="5" result="Warlock"/>
                            <case match="6" result="101 Rooms"/>
                            <case match="7" result="Spaceship Battles"/>
                            <case match="8" result="Fractal Descent"/>
                            <case match="9" result="Monument Valley"/>
                            <case match="10" result="Balloons DTM"/>
                            <case match="11" result="Cargo"/>
                            <case match="12" result="BoomBox"/>
                            <case match="13" result="Golden Drought"/>
                            <case match="14" result="Directrix"/>
                            <case match="15" result="Hot Dam"/>
                            <case match="16" result="Canopy"/>
                        </switch>
                    </replacements>
                </message>
            </action>
        </action>
    </trigger>
    <!-- finish game -->
    <trigger scope="match">
        <filter>
            <after duration="90s" filter="all(someone_won=1,match-running)" message="Someone won! Game ending in {0}"/>
        </filter>
        <action>
            <switch-scope inner="player" filter="did_win=1">
                <set var="score" value="18"/>
            </switch-scope>
        </action>
    </trigger>
    <trigger scope="player" filter="current_stage=17">
        <action>
            <switch-scope inner="match">
                <set var="should_finish" value="1"/>
                <switch-scope inner="player" filter="not(current_stage=17)">
                    <set var="should_finish" value="0"/>
                </switch-scope>
                <action filter="should_finish=1">
                    <switch-scope inner="player" filter="did_win=1">
                        <set var="score" value="18"/>
                    </switch-scope>
                </action>
            </switch-scope>
        </action>
    </trigger>
</actions>
<consumables>
    <consumable id="button-consumable" action="press-button" on="right click" consume="false"/>
</consumables>
<damage>
    <deny>
        <any>
            <cause>fall</cause>
            <attacker>
                <always/>
            </attacker>
        </any>
    </deny>
</damage>
<itemremove>
    <item>leather boots</item>
    <item>wool</item>
</itemremove>
<broadcasts>
    <tip after="10s" every="2m">Search for wood buttons, stone buttons are just decoration!</tip>
</broadcasts>
<hunger>
    <depletion>off</depletion>
</hunger>
</map>